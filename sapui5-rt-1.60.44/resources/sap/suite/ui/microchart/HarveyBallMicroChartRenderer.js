/*!
* SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2018 SAP SE. All rights reserved
*/
sap.ui.define(["sap/ui/thirdparty/jquery","sap/m/library","sap/ui/Device","./library","./HarveyBallMicroChart","sap/base/security/encodeXML","sap/suite/ui/microchart/MicroChartRenderUtils","sap/ui/core/theming/Parameters","sap/m/ValueColor","sap/m/ValueCSSColor"],function(q,M,D,l,H,e,a,P,V,b){"use strict";var c={};c._iReferenceControlHeight=72;c._iReferenceControlWidth=168;c.render=function(r,C){if(C._hasData()){if(!C._bThemeApplied){return;}this._calculatePath(C);var d=C.getColorPalette();var R=sap.ui.getCore().getConfiguration().getRTL();var t="";var v="";var s="";var f=false;var g=0;var h="";var G=function(i){if(V[i]){h="sapSuiteHBMCSemanticColor"+e(i);}else if(b.isValid(i)){return P.get(i)||i;}return null;};var i=d.length>0?G(d[0]):null;var j=this._oPath.center;if(C._isThemeHighContrast()){j-=1;}if(C.getItems().length){var p=C.getItems()[0];g=p.getFraction();v=p.getFractionLabel()?p.getFractionLabel():v+p.getFraction();s=p.getFractionScale()?p.getFractionScale().substring(0,3):s;f=p.getFormattedLabel();if(!i&&!h){i=G(p.getColor());}}if(f){var F=C._parseFormattedValue(v);s=F.scale.substring(0,3);v=F.value;}var T=C.getTotal();var k=C.getTotalLabel()?C.getTotalLabel():""+C.getTotal();if(C.getTotalScale()){t=C.getTotalScale().substring(0,3);}if(C.getFormattedLabel()){var o=C._parseFormattedValue(k);t=o.scale.substring(0,3);k=o.value;}if(v){v=H._truncateValue(v,H.VALUE_TRUNCATION_DIGITS);}if(k){k=H._truncateValue(k,H.VALUE_TRUNCATION_DIGITS);}var S="sapSuiteHBMCSize"+C.getSize();r.write("<div");this._writeMainProperties(r,C);r.writeClasses();r.writeStyles();r.write(">");r.write("<div");r.addClass("sapSuiteHBMCChart");r.addClass(C.getIsResponsive()?"sapSuiteHBMCResponsive":e(S));r.writeClasses();r.addStyle("display","inline-block");r.writeStyles();r.write(">");r.write("<svg");r.writeAttribute("id",C.getId()+"-harvey-ball");if(C.getIsResponsive()){r.addClass("sapSuiteHBMCChart");r.addClass("sapSuiteHBMCResponsive");r.writeClasses();r.writeAttributeEscaped("viewBox",this._getSvgViewBoxProperties());}else{r.writeAttributeEscaped("width",this._oPath.size);r.writeAttributeEscaped("height",this._oPath.size);}r.writeAttribute("focusable",false);r.write(">");r.write("<g>");r.write("<circle");if(R&&C.getIsResponsive()){r.writeAttributeEscaped("cx",c._iReferenceControlWidth-this._oPath.center);}else{r.writeAttributeEscaped("cx",this._oPath.center);}r.writeAttributeEscaped("cy",this._oPath.center);r.writeAttributeEscaped("r",j);r.addClass("sapSuiteHBMCBackgroundCircle");r.writeClasses();r.write("/>");if(g&&g>=T){r.write("<circle");if(R&&C.getIsResponsive()){r.writeAttributeEscaped("cx",c._iReferenceControlWidth-this._oPath.center);}else{r.writeAttributeEscaped("cx",this._oPath.center);}r.writeAttributeEscaped("cy",this._oPath.center);r.writeAttributeEscaped("r",j-this._oPath.border);r.addClass("sapSuiteHBMCSegment");if(i){r.addStyle("fill",i);r.writeStyles();}else{r.addClass(e(h));}r.writeClasses();r.write("/>");}else if(g>0){r.write("<path");r.writeAttribute("id",C.getId()+"-segment");r.addClass("sapSuiteHBMCSegment");if(i){r.addStyle("fill",i);r.writeStyles();}else{r.addClass(e(h));}r.writeClasses();r.writeAttributeEscaped("d",this._serializePieChart());r.write("/>");}r.write("</g>");if(C.getIsResponsive()){if(C.getShowFractions()){r.write("<text");r.writeAttribute("id","sapSuiteHBMCTopText");if(R&&(D.browser.msie||D.browser.edge)){r.writeAttribute("text-anchor","end");}else{r.writeAttribute("text-anchor","start");}r.writeAttribute("x","80");r.writeAttribute("y","30");r.addClass("sapSuiteHBMCResponsive");r.addClass("sapSuiteHBMCValueContainer");if(!i){r.addClass(e(h));}r.writeClasses();r.write(">");if(!R){this.renderFractionLabel(r,v,i,R);this.renderFractionScale(r,s,i,R);}else{this.renderFractionScale(r,s,i,R);this.renderFractionLabel(r,v,i,R);}r.write("</text>");}if(C.getShowTotal()){r.write("<text");r.writeAttribute("id","sapSuiteHBMCBottomText");if(!R){r.writeAttributeEscaped("x",c._iReferenceControlWidth);}else{r.writeAttribute("x","0");}r.writeAttribute("y","65");if(R&&(D.browser.msie||D.browser.edge)){r.writeAttribute("text-anchor","start");}else{r.writeAttribute("text-anchor","end");}r.addClass("sapSuiteHBMCResponsive");r.addClass("sapSuiteHBMCTotal");r.addClass("sapSuiteHBMCTotalContainer");r.writeClasses();r.write(">");if(!R){this.renderTotalLabel(r,k,R);this.renderTotalScale(r,t,R);}else{this.renderTotalScale(r,t,R);this.renderTotalLabel(r,k,R);}r.write("</text>");}}r.write("</svg>");r.write("</div>");if(!C.getIsResponsive()){r.write("<div");r.addClass("sapSuiteHBMCValueContainer");r.addClass(e(S));r.writeClasses();r.addStyle("display",C.getShowFractions()?"inline-block":"none");r.writeStyles();r.write(">");this.renderLabel(r,C,[h,S,"sapSuiteHBMCValue"],v,i,"-fraction");this.renderLabel(r,C,[h,S,"sapSuiteHBMCValueScale"],s,i,"-fraction-scale");r.write("</div>");r.write("<div");r.addClass("sapSuiteHBMCTotalContainer");r.addClass(e(S));r.writeClasses();if(R){r.addStyle("left","0");}else{r.addStyle("right","0");}r.addStyle("display",C.getShowTotal()?"inline-block":"none");r.writeStyles();r.write(">");this.renderLabel(r,C,[h,S,"sapSuiteHBMCTotal"],k,i,"-total");this.renderLabel(r,C,[h,S,"sapSuiteHBMCTotalScale"],t,i,"-total-scale");r.write("</div>");}r.write("</div>");}else{r.write("<div");this._writeMainProperties(r,C);r.writeClasses();r.writeStyles();r.write(">");this._renderNoData(r);r.write("</div>");}};c._writeMainProperties=function(r,C){var i=C.hasListeners("press");this._renderActiveProperties(r,C);var A=C.getAltText(i);r.writeAttribute("role","img");if(C.getAriaLabelledBy().length){r.writeAccessibilityState(C);}else{r.writeAttributeEscaped("aria-label",A);}r.writeControlData(C);r.addClass("sapSuiteHBMC");r.addClass(C.getIsResponsive()?"sapSuiteHBMCResponsive":"sapSuiteHBMCSize"+C.getSize());if(!C.getIsResponsive()&&C.getWidth()){r.addStyle("width",C.getWidth());}};c.renderFractionLabel=function(r,f,C,R){r.write("<tspan");if(R){r.writeAttribute("dx","4.8px");}if(C){r.addStyle("fill",C);r.writeStyles();}r.write(">");r.writeEscaped(f);r.write("</tspan>");};c.renderFractionScale=function(r,f,C,R){r.write("<tspan");r.writeAttribute("font-size","0.8rem");if(!R){r.writeAttribute("dx","4.8px");}if(C){r.addStyle("fill",C);r.writeStyles();}r.write(">");r.writeEscaped(f);r.write("</tspan>");};c.renderTotalLabel=function(r,t,R){r.write("<tspan");if(R){r.writeAttribute("dx","4.8px");}else if(D.browser.msie||D.browser.edge){r.writeAttribute("dx","-4.8px");}r.write(">");r.writeEscaped(t);r.write("</tspan>");};c.renderTotalScale=function(r,t,R){r.write("<tspan");if(!R){r.writeAttribute("dx","4.8px");}r.write(">");r.writeEscaped(t);r.write("</tspan>");};c.renderLabel=function(r,C,d,L,s,I){var u=!(d.indexOf("sapSuiteHBMCTotal")>-1||d.indexOf("sapSuiteHBMCTotalScale")>-1);r.write("<span");r.writeAttribute("id",C.getId()+I);for(var i=0;i<d.length;i++){if(i===0&&s&&u){r.addStyle("color",s);r.writeStyles();}else{r.addClass(e(d[i]));}}r.writeClasses();r.write(">");if(L){r.writeEscaped(L);}r.write("</span>");};c._getSvgViewBoxProperties=function(){return"0 0 "+c._iReferenceControlWidth+" "+c._iReferenceControlHeight;};c._calculatePath=function(C){var s=C.getSize();var t=C.getTotal();var f=0;if(C.getItems().length){f=C.getItems()[0].getFraction();}var i=false;if(s=="Auto"){i=q("html").hasClass("sapUiMedia-Std-Phone");}if(s=="S"||s=="XS"){i=true;}var m=i?56:72;if(C.getIsResponsive()){m=c._iReferenceControlHeight;}var d=m/2;var B=4;var r=sap.ui.getCore().getConfiguration().getRTL();var R;if(C.getIsResponsive()&&r){R=true;}else{R=false;}this._oPath={initial:{x:!R?d:c._iReferenceControlWidth-d,y:d,x1:!R?d:c._iReferenceControlWidth-d,y1:d},lineTo:{x:!R?d:c._iReferenceControlWidth-d,y:B},arc:{x1:d-B,y1:d-B,xArc:0,largeArc:0,sweep:1,x2:"",y2:""},size:m,border:B,center:d};var A=f/t*360;if(A<10){this._oPath.initial.x-=1.5;this._oPath.initial.x1+=1.5;this._oPath.arc.x2=this._oPath.initial.x1;this._oPath.arc.y2=this._oPath.lineTo.y;}else if(A>350&&A<360){this._oPath.initial.x+=1.5;this._oPath.initial.x1-=1.5;this._oPath.arc.x2=this._oPath.initial.x1;this._oPath.arc.y2=this._oPath.lineTo.y;}else{var g=Math.PI/180.0;var h=this._oPath.center-this._oPath.border;var j;if(!R){j=h*Math.cos((A-90)*g)+this._oPath.center;}else{j=h*Math.cos((A-90)*g)+c._iReferenceControlWidth-this._oPath.center;}var k=this._oPath.size-(h*Math.sin((A+90)*g)+this._oPath.center);this._oPath.arc.x2=j.toFixed(2);this._oPath.arc.y2=k.toFixed(2);}var L=t/f<2?1:0;this._oPath.arc.largeArc=L;};c._serializePieChart=function(){var p=this._oPath;return["M",p.initial.x,",",p.initial.y," L",p.initial.x,",",p.lineTo.y," A",p.arc.x1,",",p.arc.y1," ",p.arc.xArc," ",p.arc.largeArc,",",p.arc.sweep," ",p.arc.x2,",",p.arc.y2," L",p.initial.x1,",",p.initial.y1," z"].join("");};a.extendMicroChartRenderer(c);return c;},true);
