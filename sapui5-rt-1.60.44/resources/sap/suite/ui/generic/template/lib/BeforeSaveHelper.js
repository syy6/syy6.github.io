sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(q,B,F,a){"use strict";var A=new F({filters:[new F({path:"type",operator:a.EQ,value1:sap.ui.core.MessageType.Warning}),new F({path:"type",operator:a.EQ,value1:sap.ui.core.MessageType.Error})],and:false});var l="model";function g(t,c,C){var y,n;var f;var I;var s=(function(){var o=c.getOwnerComponent();var r=t.componentRegistry[o.getId()];return!!(r.methods.showConfirmationOnDraftActivate&&r.methods.showConfirmationOnDraftActivate());})();function b(j){var k=t.oNavigationControllerProxy.getActiveComponents();var r;for(var i=0;i<k.length&&!r;i++){var m=k[i];var R=t.componentRegistry[m];r=R.viewLevel&&(R.methods.getScrollFunction||q.noop)(j);}return r||null;}function d(S){var r,L,m;r=C.getDialogFragment("sap.suite.ui.generic.template.fragments.MessagesBeforeSave",{itemSelected:function(){L.setProperty("/backbtnvisibility",true);},onBackButtonPress:function(){m.navigateBack();L.setProperty("/backbtnvisibility",false);},onAccept:function(){f=y;r.close();},onReject:function(){f=n;r.close();},isPositionable:function(w){return!!(w&&b(w));},titlePressed:function(E){r.close();var M=E.getParameter("item");var w=M.getBindingContext("msg").getObject();f=b(w.controlIds);r.close();},afterClose:function(){y=null;n=null;(f||q.noop)();f=null;}},l,function(w){m=w.getContent()[0];w.setModel(sap.ui.getCore().getMessageManager().getMessageModel(),"msg");I=w.getContent()[0].getBinding("items");});L=r.getModel(l);L.setProperty("/situation",S);L.setProperty("/backbtnvisibility",false);var j=[];var k=t.oNavigationControllerProxy.getActiveComponents();var o=(S<3);for(var i=0;i<k.length;i++){var u=k[i];var R=t.componentRegistry[u];if(R.oController===c||S!==2){var v=(R.methods.getMessageFilters||q.noop)(o);j=v?j.concat(v):j;}}if(j.length===0){return null;}var O=j.length===1?j[0]:new F({filters:j,and:false});if(S===3){O=new F({filters:[O,A],and:true});}I.filter(O);return I.getLength()&&r;}function e(i){var v=d(i?1:2);if(v){v.open();return Promise.reject();}if(!(i&&s)){return Promise.resolve();}v=d(3);return v?new Promise(function(r,R){y=r;n=R;v.open();}):Promise.resolve();}function p(i,o){t.oApplicationProxy.performAfterSideEffectExecution(function(){if(!t.oBusyHelper.isBusy()){e(i).then(o);}});}function h(){return!!d(1);}return{prepareAndRunSaveOperation:p,hasValidationMessageOnDetailsViews:h};}return B.extend("sap.suite.ui.generic.template.lib.BeforeSaveHelper",{constructor:function(t,c,C){q.extend(this,g(t,c,C));}});});
