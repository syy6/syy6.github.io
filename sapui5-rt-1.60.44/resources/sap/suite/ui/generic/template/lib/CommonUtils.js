sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/base/Event","sap/ui/core/mvc/ControllerExtension","sap/ui/Device","sap/ui/model/Context","sap/ui/model/Filter","sap/ui/model/json/JSONModel","sap/m/Table","sap/m/ListBase","sap/m/MessageBox","sap/ui/generic/app/navigation/service/NavigationHandler","sap/ui/generic/app/navigation/service/NavError","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,E,C,D,a,F,J,R,L,M,N,b,t){"use strict";var c=sap.ui.getCore();function d(e,P){var i=sap.ui.require(P);return typeof i==="function"&&(e instanceof i);}function f(e){return d(e,"sap/ui/comp/smarttable/SmartTable");}function g(e){return d(e,"sap/ui/comp/smartchart/SmartChart");}function h(e){return d(e,"sap/ui/table/Table");}function l(e){return d(e,"sap/ui/table/AnalyticalTable");}function m(e){return d(e,"sap/ui/table/TreeTable");}function n(e){return d(e,"sap/m/Table");}function o(e){if(g(e)||f(e)){return e.getEntitySet();}else if(f(e.getParent())){return e.getParent().getEntitySet();}}function p(S){var e,i,j,k;e=S.getEntitySet();i=S.getModel().getMetaModel();j=i.getODataEntitySet(e);k=i.getODataEntityType(j.entityType);return k;}function r(S,e){var T=e&&sap.ui.getCore().byId(e);if(T){if(S.scrollToElement){S.scrollToElement(T.getDomRef());}T.focus();}}var f=t.testableStatic(f,"CommonUtils_isSmartTable");function s(u,S,v){var w;var x=Object.create(null);function y(e,i,j){var k=e instanceof E?e.getSource():e;var N1=k.getId();var O1=x[N1];if(!O1){if(j){return null;}O1={control:k,infoObject:Object.create(null),categories:[]};(i||q.noop)(O1.infoObject,O1.categories,k);x[N1]=O1;}return O1.infoObject;}function z(e,i){for(var j in x){var k=x[j];if(k.categories.indexOf(e)>=0){i(k.infoObject,k.control);}}}function A(e){S.oApplication.attachControlToParent(e,u.getView());}function G(e){if(e.getVisible&&!e.getVisible()){return null;}return e.getParent()||e.oContainer;}function H(e){var i=u.getView();var j=false;for(var k=i.getVisible()&&c.byId(e);k&&!j;k=G(k)){j=k===i;}return j;}function I(e){for(var i=0;i<e.length;i++){var j=e[i];if(H(j)){return j;}}return"";}function K(e,i,j,k){return S.oApplication.getDialogFragmentForView(u.getView(),e,i,j,k);}var O;function P(){O=O||u.getOwnerComponent().getModel("i18n").getResourceBundle();return O.getText.apply(O,arguments);}function Q(k,i,e){var j,N1,O1;j=k+"|"+i;N1=e||k;O1=P(j);if(O1===j){O1=P(N1);}return O1;}function T(e,i){var i=i||e.getSelectionBehavior();if(i==="DATAPOINT"){return{"dataPoints":e.getSelectedDataPoints().dataPoints,"count":e.getSelectedDataPoints().count};}else if(i==="CATEGORY"){return{"dataPoints":e.getSelectedCategories().categories,"count":e.getSelectedCategories().count};}else if(i==="SERIES"){return{"dataPoints":e.getSelectedSeries().series,"count":e.getSelectedSeries().count};}}function U(e,j,k){var N1=[];if(f(e)){e=e.getTable();}else if(g(e)){e=e.getChart();if(e&&e.getMetadata().getName()==="sap.chart.Chart"){var O1=false;j=j||e.getSelectionBehavior();k=k||T(e,j);if(k&&k.count>0){if(j==="DATAPOINT"){O1=true;}var P1=k.dataPoints;var Q1=[];for(var i=0;i<P1.length;i++){if(O1){if(P1[i].context){N1.push(P1[i].context);}}else{Q1.push(P1[i].dimensions);}}if(!O1){N1[0]=Q1;}}}}if(e instanceof L){N1=e.getSelectedContexts();}else if(h(e)){var R1=e.getSelectedIndices();for(var i=0;i<R1.length;i++){N1.push(e.getContextByIndex(R1[i]));}}return N1;}function V(e){var i={};if(e instanceof sap.ui.core.Element){e.getCustomData().forEach(function(j){i[j.getKey()]=j.getValue();});}return i;}function W(e){var k,N1,O1,P1;var Q1=g1(e);if(!f(Q1)&&!g(Q1)){Q1=Q1.getParent();}var R1=U(Q1);var S1=Q1.getModel();N1=d1(Q1);b1(N1,R1,S1,Q1);if(f(Q1)){k=Q1.getCustomToolbar()&&Q1.getCustomToolbar().getContent();}else if(g(Q1)){k=Q1.getToolbar()&&Q1.getToolbar().getContent();}if(k&&k.length>0){for(var i=0;i<k.length;i++){O1=k[i];if(O1.getMetadata().getName()==="sap.m.Button"&&O1.getVisible()){X(O1,S1,R1,Q1);}else if(O1.getMetadata().getName()==="sap.m.MenuButton"){P1=O1.getMenu().getItems();if(P1&&P1.length>0){for(var j=0;j<P1.length;j++){O1=P1[j];if(O1.getVisible()){X(O1,S1,R1,Q1);}}}}}}}function X(e,i,j,k){var N1,O1;var P1=V(e);var Q1=u.getView();var R1=i.getMetaModel();if(P1&&P1.Type){if(P1.originalButtonId){N1=Q1.getLocalId(P1.originalButtonId);}else{N1=Q1.getLocalId(e.getId());}if(P1.Type==="CRUDActionDelete"){O1=_(i,R1,j,k);k.getModel("_templPriv").setProperty("/listReport/deleteEnabled",O1);}else if(P1.Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||P1.Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){O1=$(i,R1,j,P1.Type,P1.Action,k);}}if(/generic\/controlProperties/.test(e.getBindingPath("enabled"))&&O1!==undefined){Z(N1,"enabled",O1);}}function Y(e){var i;var j=g1(e);var k=U(j);var N1=e.getModel();i=e1();b1(i,k,N1,j);}function Z(i,e,j){var k=u.getView().getModel("_templPriv");var N1=k.getProperty("/generic/controlProperties/"+i);if(!N1){N1={};N1[e]=j;k.setProperty("/generic/controlProperties/"+i,N1);}else{k.setProperty("/generic/controlProperties/"+i+"/"+e,j);}}function $(e,i,k,N1,O1,P1){var Q1,R1,S1,T1;var U1=false;if(N1==="com.sap.vocabularies.UI.v1.DataFieldForAction"){Q1=i.getODataFunctionImport(O1);S1=Q1&&Q1["sap:action-for"];if(S1&&S1!==""&&S1!==" "){if(k.length>0){T1=Q1["sap:applicable-path"];if(T1&&T1!==""&&T1!==" "){for(var j=0;j<k.length;j++){if(!k[j]){continue;}R1=e.getObject(k[j].getPath());if(R1&&R1[T1]){U1=true;break;}}}else{U1=true;}}}else{U1=true;}}else if(N1==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){if(k.length>0||(g(P1)&&P1.getDrillStackFilters().length>0)){U1=true;}}return U1;}function _(e,j,k,N1){var O1=a1(N1);var P1=false;var Q1;var R1=j.getODataEntitySet(N1.getEntitySet());if(sap.suite.ui.generic.template.js.AnnotationHelper.areDeleteRestrictionsValid(j,R1.entityType,O1)){if(k.length>0){var S1=O1&&O1.Deletable&&O1.Deletable.Path;for(var i=0;i<k.length;i++){Q1=e.getObject(k[i].getPath());if(!Q1){break;}if(S1){if(k[i]&&e.getProperty(S1,k[i])){if(!(Q1.IsActiveEntity&&Q1.HasDraftEntity&&Q1.DraftAdministrativeData&&e.getProperty("DraftAdministrativeData/InProcessByUser",k[i]))){P1=true;break;}}}else{if(!(Q1.IsActiveEntity&&Q1.HasDraftEntity&&Q1.DraftAdministrativeData&&e.getProperty("DraftAdministrativeData/InProcessByUser",k[i]))){P1=true;break;}}}}}return P1;}function a1(e){var i=e.getModel()&&e.getModel().getMetaModel();var j=i&&i.getODataEntitySet(e.getEntitySet());var k=j&&j["Org.OData.Capabilities.V1.DeleteRestrictions"];return k;}function b1(e,i,j,k){var N1=f1(k);var O1=u.getView().getModel("_templPriv");var P1=O1.getProperty("/generic/listCommons/breakoutActionsEnabled");if(N1){var Q1=u.byId("template::IconTabBar");var R1="";if(Q1){R1=Q1.getSelectedKey();}c1(P1,N1,e,i,j,R1,k);}O1.setProperty("/generic/listCommons/breakoutActionsEnabled",P1);}function c1(e,i,j,k,N1,O1,P1){var Q1;for(var R1 in i){Q1=true;if(i[R1].requiresSelection){if(k.length>0){if(i[R1].applicablePath!==undefined&&i[R1].applicablePath!==""){Q1=false;for(var S1=0;S1<k.length;S1++){var T1="";var U1=i[R1].applicablePath.split("/");if(U1.length>1){for(var V1=0;V1<U1.length-1;V1++){T1+="/"+U1[V1];}}var W1=N1.getObject(k[S1].getPath()+T1);var X1=U1[U1.length-1];if(W1[X1]===true){Q1=true;break;}}}}else if(g(P1)&&P1.getDrillStackFilters().length>0){Q1=true;}else{Q1=false;}}var Y1=i[R1].id+((O1&&!i[R1].determining)?"-"+O1:"");e[Y1]={enabled:Q1};}}function d1(e){var i=[];var j=f1(e);for(var k in j){i.push(j[k].id);}return i;}function e1(){var e=[];var i=f1();for(var j in i){if(i[j].determining){e.push(j);}}return e;}function f1(e){var i=u.getOwnerComponent().getAppComponent().getManifestEntry("sap.ui5");var j=i.extends&&i.extends.extensions&&i.extends.extensions["sap.ui.controllerExtensions"];j=j&&j[u.getOwnerComponent().getTemplateName()];j=j&&j["sap.ui.generic.app"];var k=u.getOwnerComponent().getEntitySet();var N1=V(e).sectionId;if(!N1){return j&&j[k]&&j[k]["Actions"];}else{var O1=j&&j[k]&&j[k]["Sections"];return O1&&O1[N1]&&O1[N1].Actions;}}function g1(e){var i=e;while(i){if(i instanceof R||h(i)||f(i)||g(i)){return i;}i=i.getParent&&i.getParent();}return null;}function h1(e){if(f(e)){e=e.getTable();}if(h(e)){return e.getBindingInfo("rows");}else if(e instanceof R){return e.getBindingInfo("items");}return null;}function i1(e){var i=h1(e);if(i&&i.binding){i.binding.refresh();}else if(e&&e.rebindTable){e.rebindTable();}}function j1(e){var i=u.getOwnerComponent();var j=i.getModel();var k,N1;var O1=!S.oApplication.checkEtags();if(O1){N1=h1(e);if(N1){k=N1.path;var P1=e.getEntitySet();var Q1=j.getMetaModel();var R1=Q1.getODataEntitySet(P1);if(u.getMetadata().getName()==='sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage'&&k1(j,R1)){j.invalidateEntityType(R1.entityType);}else{j.invalidate(l1.bind(null,k));}var S1=i.getId();var T1=Object.create(null);T1[S1]=true;S.oApplication.refreshAllComponents(T1);}}}function k1(e,i){q.sap.require("sap.ui.model.analytics.odata4analytics");var j=new sap.ui.model.analytics.odata4analytics.Model(sap.ui.model.analytics.odata4analytics.Model.ReferenceByModel(e));var k=j.findQueryResultByName(i.name);var N1=k&&k.getParameterization();return!!N1;}function l1(e,k,i){var j=e[0]==="/"?e.substr(1):e;if(k.split("(")[0]===j){return true;}else{return false;}}function m1(e,i){var j=e.getPath();var k=u.getOwnerComponent();var N1=k.getComponentContainer().getElementBinding();var O1=N1?N1.getPath():"";var P1=null;if(j.indexOf(O1)!==0){P1=h1(i).path;}var Q1=!S.oApplication.isNewHistoryEntryRequired(e,P1);var R1;if(v.isDraftEnabled()){R1=S.oDraftController.isActiveEntity(e)?1:6;}else{R1=k.getModel("ui").getProperty("/editable")?6:1;}var S1=v.getViewLevel();if(S1===0){var T1=S.oApplication.getForwardNavigationProperty(S1);}if(T1){var U1=new Promise(function(W1){e.getModel().createBindingContext(T1,e,null,function(X1){if(X1){S.oNavigationController.navigateToContext(X1,P1,Q1,R1);W1();}else{v.navigateToDataLoadedFailedPage();W1();}});});var V1=S.oApplication.getBusyHelper();V1.setBusy(U1);}else{S.oNavigationController.navigateToContext(e,P1,Q1,R1);}}function n1(e,i){if(e instanceof a){S.oNavigationController.navigateToContext(e,i&&i.navigationProperty,i&&i.replaceInHistory);return;}var j=i&&i.routeName;if(j){v.navigateRoute(j,e,null,i&&i.replaceInHistory);return;}q.sap.log.warning("navigateToContext called without context or route");}function o1(e){if(e instanceof b){if(e.getErrorCode()==="NavigationHandler.isIntentSupported.notSupported"){M.show(P("ST_NAV_ERROR_NOT_AUTHORIZED_DESC"),{title:P("ST_GENERIC_ERROR_TITLE")});}else{M.show(e.getErrorCode(),{title:P("ST_GENERIC_ERROR_TITLE")});}}}function p1(e,i){D1(function(){w=K1();var j={semanticObject:e.semanticObject,action:e.action};var k=w.mixAttributesAndSelectionVariant(e.parameters);u.adaptNavigationParameterExtension(k,j);w.navigate(e.semanticObject,e.action,k.toJSONString(),null,o1);},q.noop,i,"LeavePage");}function q1(e){var N1=[],O1,P1,Q1;var R1=u.getOwnerComponent();var S1=R1.getModel().getMetaModel();if(!e){return{};}var T1=R1.getAppComponent().getConfig().pages[0];if(!T1){return{};}var U1=function(i){Q1=S1.getODataEntitySet(i.entitySet).entityType;P1=S1.getODataEntityType(Q1);O1={};O1={entitySet:i.entitySet,aKeys:S1.getODataEntityType(Q1).key.propertyRef,navigationProperty:i.navigationProperty};for(var j=0,W1=O1.aKeys.length;j<W1;j++){var k=0,X1=P1.property.length;for(k;k<X1;k++){if(O1.aKeys[j].name===P1.property[k].name){O1.aKeys[j].type=P1.property[k].type;break;}}}};var V1=function(e,T1){if(!T1.pages){return N1;}for(var i=0,j=T1.pages.length;i<j;i++){if(!T1.pages[i]){break;}if(e===T1.pages[i].entitySet){U1(T1.pages[i]);N1.splice(0,0,O1);break;}N1=V1(e,T1.pages[i]);if(N1.length>0){U1(T1.pages[i]);N1.splice(0,0,O1);}}return N1;};return V1(e,T1);}function r1(k,e){var N1,O1,i,P1;for(i=0,P1=k.length;i<P1;i++){if(k[i].navigationProperty){O1+="/"+k[i].navigationProperty;}else{O1="/"+k[i].entitySet;}for(var j=0,Q1=k[i].aKeys.length;j<Q1;j++){if(j===0){O1+="(";N1="";}else{N1=",";}switch(k[i].aKeys[j].type){case"Edm.Guid":if(e.DraftAdministrativeData&&e.DraftAdministrativeData.DraftIsCreatedByMe){O1+=N1+k[i].aKeys[j].name+"="+"guid'"+e.DraftAdministrativeData[k[i].aKeys[j].name]+"'";}else{O1+=N1+k[i].aKeys[j].name+"="+"guid'"+e[k[i].aKeys[j].name]+"'";}break;case"Edm.Boolean":if(e.DraftAdministrativeData&&e.DraftAdministrativeData.DraftIsCreatedByMe){O1+=N1+k[i].aKeys[j].name+"="+false;}else{O1+=N1+k[i].aKeys[j].name+"="+e[k[i].aKeys[j].name];}break;default:if(typeof e[k[i].aKeys[j].name]==="string"){O1+=N1+k[i].aKeys[j].name+"="+"'"+e[k[i].aKeys[j].name]+"'";}else{O1+=N1+k[i].aKeys[j].name+"="+e[k[i].aKeys[j].name];}break;}if(j===(Q1-1)){O1+=")";}}}return O1;}function s1(e,k,u){var N1,O1,P1,Q1,R1,S1,T1;var U1={semanticObject:"",action:""};w=K1();for(Q1 in e.semanticAttributesOfSemanticObjects){N1=w.mixAttributesAndSelectionVariant({},k);for(P1 in e.semanticAttributesOfSemanticObjects[Q1]){if(!N1.getSelectOption(P1)){N1.addParameter(P1,"");}}R1=N1.getPropertyNames();U1.semanticObject=Q1;u.adaptNavigationParameterExtension(N1,U1);S1=N1.getSelectOptionsPropertyNames();T1=N1.getParameterNames();for(var i=0,V1=R1.length;i<V1;i++){if(S1.indexOf(R1[i])<0&&T1.indexOf(R1[i])<0){delete e.semanticAttributesOfSemanticObjects[Q1][R1[i]];N1.removeSelectOption(R1[i]);}}if(Q1===e.semanticObject){var W1=e.semanticAttributesOfSemanticObjects[""];for(var j=0,V1=T1.length;j<V1;j++){if(T1[j]in W1){N1.removeParameter(T1[j]);}else{N1.removeParameter(T1[j]);var X1=e.semanticAttributesOfSemanticObjects[e.semanticObject][T1[j]];if(typeof X1==="undefined"||X1===null){X1="";}else{X1=String(X1);}N1.addParameter(T1[j],X1);}}N1=w.mixAttributesAndSelectionVariant(e.semanticAttributesOfSemanticObjects[Q1],k);O1=N1.toJSONString();}}delete e.semanticAttributes;w.processBeforeSmartLinkPopoverOpens(e,O1);}function t1(e,j){var k=function(R1){for(var i=0;i<R1.length;i++){j(R1[i].name);}};var N1=u.getView().getModel().getMetaModel();var O1=N1.getODataEntitySet(e,false);var P1=N1.getODataEntityType(O1.entityType,false);k(P1.key.propertyRef);var Q1=S.oDraftController.getDraftContext();if(Q1.isDraftEnabled(e)){k(Q1.getSemanticKey(e));j("IsActiveEntity");j("HasDraftEntity");j("HasActiveEntity");}}function u1(e,i){if(!v.isDraftEnabled()||!e){return;}var j=e.getControlByKey("EditState");var k=j&&j.getSelectedKey()||"";switch(k){case"1":i.filters.push(new F("IsActiveEntity","EQ",true));i.filters.push(new F("HasDraftEntity","EQ",false));break;case"2":i.filters.push(new F("IsActiveEntity","EQ",false));break;case"3":i.filters.push(new F("IsActiveEntity","EQ",true));i.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));i.filters.push(new F("DraftAdministrativeData/InProcessByUser","NE",""));break;case"4":i.filters.push(new F("IsActiveEntity","EQ",true));i.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));i.filters.push(new F("DraftAdministrativeData/InProcessByUser","EQ",""));break;default:var N1=new F({filters:[new F("IsActiveEntity","EQ",false),new F("SiblingEntity/IsActiveEntity","EQ",null)],and:false});if(i.filters[0]&&i.filters[0].aFilters){var O1=i.filters[0];i.filters[0]=new F([O1,N1],true);}else{i.filters.push(N1);}break;}}function v1(e,i){if(i){e.filters.push(new F("IsActiveEntity","EQ",true));}else{var j=new F({filters:[new F("IsActiveEntity","EQ",false),new F("SiblingEntity/IsActiveEntity","EQ",null)],and:false});if(e.filters[0]&&e.filters[0].aFilters){var k=e.filters[0];e.filters[0]=new F([k,j],true);}else{e.filters.push(j);}}}function w1(i,j,k){if(j&&i&&i.getAnalyticBindingPath&&i.getConsiderAnalyticalParameters()){try{var N1=i.getAnalyticBindingPath();if(N1){j(N1);}}catch(e){q.sap.log.warning("Mandatory parameters have no values","",k);}}}function x1(e,j,k){for(var i=0;i<j.length;i++){var N1=j[i];var O1=N1.lastIndexOf("/");var P1;if(O1<0){if(S.oApplication.getNavigationProperty(e,N1)){P1=N1;}else{continue;}}else{P1=N1.substring(0,O1);}if(k.indexOf(P1)===-1){k.push(P1);}}}function y1(e,i,j){var k=e.getParameter("bindingParams"),N1=e.getSource().getId();k.parameters=k.parameters||{};var O1=v.getTemplatePrivateModel();var P1=O1.getProperty("/listReport/vDraftState");var Q1=O1.getProperty("/listReport/activeObjectEnabled");var R1=function(Y1,Z1,N1){if(i&&i[Y1]){var $1=true;var _1=function(){var a2=arguments[0];if(!(a2 instanceof C)){throw new Error("Please provide a valid ControllerExtension in order to execute extension "+Y1);}if(!$1){throw new Error("Extension "+Y1+" must be executed synchronously");}var b2=Array.prototype.slice.call(arguments,1);Z1.apply(null,b2);};i[Y1](_1,N1);$1=false;}};var S1=function(Y1){if(!N1||u.byId(N1)===e.getSource()){k.filters.push(Y1);}};if((u.getMetadata().getName()!=='sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage')||(u.getMetadata().getName()!=='sap.suite.ui.generic.template.ObjectPage.view.Details')){if(P1=="0"&&v.isDraftEnabled()){v1(k,Q1);}else{u1(j,k);}}R1("addExtensionFilters",S1,N1);if(u.getMetadata().getName()!=='sap.suite.ui.generic.template.ObjectPage.view.Details'){w1(j,i.setBindingPath,i.isAnalyticalListPage?"AnalyticalListPage":"ListReport");}var T1=e.getSource();var U1=T1.getEntitySet();var V1=k.parameters.select&&k.parameters.select.split(",")||[];var W1=k.parameters.expand&&k.parameters.expand.split(",")||[];var X1=function(Y1,N1){if(Y1&&(!N1||u.byId(N1)===e.getSource())){var Z1=Y1.split(',');Z1.forEach(function($1){if($1&&q.inArray($1,V1)===-1){V1.push($1);}});}};if(!i.isAnalyticalListPage){t1(U1,X1);}R1("ensureExtensionFields",X1,N1);(i.addNecessaryFields||q.noop)(V1,X1,U1);x1(U1,V1,W1);if(W1.length>0){k.parameters.expand=W1.join(",");}if(V1.length>0){k.parameters.select=V1.join(",");}}function z1(e,i,j){if(!e){return P("DRAFT_OBJECT");}else if(i){return P(j?"LOCKED_OBJECT":"UNSAVED_CHANGES");}else{return"";}}function A1(){var e=K("sap.suite.ui.generic.template.fragments.DraftAdminDataPopover",{formatText:function(){var i=Array.prototype.slice.call(arguments,1);var k=arguments[0];if(!k){return"";}if(i.length>0&&(i[0]===null||i[0]===undefined||i[0]==="")){if(i.length>3&&(i[3]===null||i[3]===undefined||i[3]==="")){return(i.length>2&&(i[1]===null||i[1]===undefined||i[1]===""))?"":i[2];}else{return P(k,i[3]);}}else{return P(k,i[0]);}},closeDraftAdminPopover:function(){e.close();},formatDraftLockText:z1},"admin");return e;}function B1(e,i,j,k,N1,O1){var P1=S.oApplication.getBusyHelper();if(!N1&&P1.isBusy()){return;}if(!v.isDraftEnabled()){var Q1=false;if(j&&j.aUnsavedDataCheckFunctions){Q1=j.aUnsavedDataCheckFunctions.some(function(U1){return U1();});}var R1=u.getView();var S1=R1.getModel();if(Q1||S1.hasPendingChanges()){var T1;F1(function(){R1.setBindingContext(null);S1.resetChanges();R1.setBindingContext();v.fire(u,"AfterCancel",{});T1=e();},function(){T1=i();},k,O1);return T1;}}return e();}function C1(e,i,j,k){var N1=false;if(j&&j.aUnsavedDataCheckFunctions){N1=j.aUnsavedDataCheckFunctions.some(function(P1){return P1();});}if(N1||u.getView().getModel().hasPendingChanges()){var O1;H1(function(){u.getView().getModel().resetChanges();v.fire(u,"AfterCancel",{});O1=e();},function(){O1=i();},k);return O1;}return e();}function D1(e,i,j,k,N1,O1){if(N1){return B1(e,i,j,k,true,O1);}S.oApplication.performAfterSideEffectExecution(B1.bind(null,e,i,j,k,false,O1));}var E1;function F1(e,i,j,k){var N1;E1=e;if(!j||!k){var O1=K("sap.suite.ui.generic.template.fragments.DataLoss",{onDataLossOK:function(){O1.close();E1();},onDataLossCancel:function(){O1.close();i();}},"dataLoss");if(!j){j="LeavePage";}N1=O1.getModel("dataLoss");N1.setProperty("/mode",j);O1.open();}else{var P1=K("sap.suite.ui.generic.template.fragments.DiscardDraftPopover",{onDiscardConfirm:function(){E1();}},"discard");N1=P1.getModel("discard");N1.setProperty("/placement",sap.m.PlacementType.Top);if(j!=="Proceed"){N1.setProperty("/isCreateDraft",true);}else{N1.setProperty("/isCreateDraft",false);}N1.setProperty("/mode",j);P1.openBy(k.getSource());}}var G1;function H1(e,i,j){G1=e;if(!j){j="LeavePage";}var k=K("sap.suite.ui.generic.template.fragments.DataLossTechnicalError",{onDataLossOK:function(){k.close();G1();},onDataLossCancel:function(){k.close();i();}},"dataLoss");var N1=k.getModel("dataLoss");N1.setProperty("/mode",j);k.open();}function I1(e,i,j,k,N1,O1){if(i.busy.check&&k.isBusy()){O1();return;}var P1=i.busy.set?function(){k.setBusy(Promise.resolve(),false,{actionLabel:i.sActionLabel});return e();}:e;var Q1=i.mConsiderObjectsAsDeleted?function(S1){S.oApplication.prepareDeletion(i.mConsiderObjectsAsDeleted);return P1();}:P1;var R1=(i.dataloss.popup?D1(Q1,O1,j,(i.dataloss.navigation?"LeavePage":"Proceed"),true):Q1());if(R1 instanceof Promise){R1.then(N1,O1);}else{N1();}}function J1(e,i,j){i=q.extend(true,{busy:{set:true,check:true},dataloss:{popup:true,navigation:false}},i);var k=S.oApplication.getBusyHelper();var N1=new Promise(function(O1,P1){S.oApplication.performAfterSideEffectExecution(I1.bind(null,e,i,j,k,O1,P1));});if(i.busy.set){k.setBusy(N1,false,{actionLabel:i.sActionLabel});}return N1;}function K1(){w=w||new N(u);return w;}function L1(e){var j;var k=v.getTemplatePrivateModel();var N1,O1,P1,Q1,R1,S1=[],T1=[],i,U1,V1,W1,X1,Y1,Z1;var $1,_1;N1=u.getOwnerComponent().getAppComponent();O1=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService&&sap.ushell.Container.getService("CrossApplicationNavigation");P1=k.getProperty("/generic/supportedIntents/");if(g(e)){j=e.getToolbar();}else if(f(e)){j=e.getCustomToolbar();}Q1=j.getContent();R1=Q1.length;for(i=0;i<R1;i++){U1=V(Q1[i]);if(U1.hasOwnProperty("SemanticObject")&&U1.hasOwnProperty("Action")){V1=U1.SemanticObject;W1=U1.Action;X1={semanticObject:V1,action:W1,ui5Component:N1};S1.push([X1]);Y1=q.extend({},X1);Y1.bLinkIsSupported=false;T1.push(Y1);}}if(S1.length>0&&O1){Z1=O1.getLinks(S1);Z1.done(function(a2){P1=k.getProperty("/generic/supportedIntents/");$1=a2.length;for(i=0;i<$1;i++){if(a2[i][0].length>0){T1[i].bLinkIsSupported=true;}V1=T1[i].semanticObject;W1=T1[i].action;_1=k.getProperty("/generic/supportedIntents/"+V1);if(!_1){P1[V1]={};P1[V1][W1]={"visible":T1[i].bLinkIsSupported};}else if(!_1[W1]){_1[W1]={"visible":T1[i].bLinkIsSupported};}else{_1[W1]["visible"]=T1[i].bLinkIsSupported;}}k.updateBindings();});}}function M1(e,k){var N1=[],O1;var P1=V(e).variantAnnotationPath;if(!P1&&k){P1=V(k).variantAnnotationPath;}if(P1){var Q1=e.getModel();var R1=Q1.getMetaModel();var S1=e.getEntitySet();var T1=R1.getODataEntitySet(S1);var U1=R1.getODataEntityType(T1.entityType);var V1=U1[P1];if(!V1){return;}if(!V1.SelectOptions&&V1.SelectionVariant){V1=V1.SelectionVariant;if(V1.Path){var P1=V1.Path.split("@")[1];V1=P1&&U1[P1];}}if(V1.AnnotationPath){O1=V1.AnnotationPath.split("@")[1];V1=U1[O1];}for(var i in V1.SelectOptions){if(V1.SelectOptions[i].PropertyName){var W1=V1.SelectOptions[i].PropertyName.PropertyPath;for(var j in V1.SelectOptions[i].Ranges){var X1=V1.SelectOptions[i].Ranges[j].Option;X1.EnumMember=X1.EnumMember.replace("com.sap.vocabularies.UI.v1.SelectionRangeOptionType/","");var Y1=V1.SelectOptions[i].Ranges[j].Low;var Z1=V1.SelectOptions[i].Ranges[j].High;var $1=Object.keys(Y1)[0];if(Z1){var _1=Object.keys(Z1)[0];N1.push(new sap.ui.model.Filter(W1,X1.EnumMember,Y1[$1],Z1[_1]));}else{N1.push(new sap.ui.model.Filter(W1,X1.EnumMember,Y1[$1]));}}}}}return N1;}var K1=t.testable(K1,"getNavigationHandler");var b1=t.testable(b1,"fillEnabledMapForBreakoutActions");var d1=t.testable(d1,"getBreakoutActionIds");var g1=t.testable(g1,"getOwnerControl");var U=t.testable(U,"getSelectedContexts");return{isSmartTable:f,isSmartChart:g,isUiTable:h,isAnalyticalTable:l,isTreeTable:m,isMTable:n,getPositionableControlId:I,getCurrentEntitySetName:o,getMetaModelEntityType:p,getText:P,getContextText:Q,getNavigationHandler:K1,getNavigationKeyProperties:q1,mergeNavigationKeyPropertiesWithValues:r1,executeGlobalSideEffect:function(){if(v.isDraftEnabled()){var e=u.getView();e.attachBrowserEvent("keydown",function(i){var j=(i.target.type==="search")?true:false;var k=(i.target.type==="textarea")?true:false;if(i.keyCode===13&&i.ctrlKey!==true&&e.getModel("ui").getProperty("/editable")&&!j&&!k){var N1=u.getOwnerComponent().getAppComponent().getConfig();var O1=N1.settings&&N1.settings.forceGlobalRefresh;var P1;S.oApplication.addSideEffectPromise(new Promise(function(Q1){P1=Q1;}));setTimeout(function(){var Q1=S.oApplicationController.executeSideEffects(e.getBindingContext(),null,null,O1);Q1.then(function(){P1();setTimeout(function(){document.getElementById(i.target.id).focus();});});});}});}},setEnabledToolbarButtons:W,setEnabledFooterButtons:Y,fillEnabledMapForBreakoutActions:b1,getBreakoutActions:f1,getSelectedContexts:U,getSelectionPoints:T,getDeleteRestrictions:a1,setPrivateModelControlProperty:Z,navigateFromListItem:m1,navigateToContext:n1,navigateExternal:p1,semanticObjectLinkNavigation:s1,getSelectionVariantFilters:M1,getCustomData:function(e){var j=e.getSource().getCustomData();var k={};for(var i=0;i<j.length;i++){k[j[i].getKey()]=j[i].getValue();}return k;},onBeforeRebindTableOrChart:y1,formatDraftLockText:z1,showDraftPopover:function(e,i){var j=A1();var k=j.getModel("admin");k.setProperty("/IsActiveEntity",e.getProperty("IsActiveEntity"));k.setProperty("/HasDraftEntity",e.getProperty("HasDraftEntity"));j.bindElement({path:e.getPath()+"/DraftAdministrativeData"});if(j.getBindingContext()){j.openBy(i);}else{j.getObjectBinding().attachDataReceived(function(){j.openBy(i);});}},getContentDensityClass:function(){return S.oApplication.getContentDensityClass();},attachControlToView:A,getDialogFragment:K,processDataLossConfirmationIfNonDraft:D1,processDataLossTechnicalErrorConfirmation:C1,securedExecution:J1,getOwnerControl:g1,getTableBindingInfo:h1,refreshSmartTable:i1,refreshModel:j1,getElementCustomData:V,triggerAction:function(e,i,j,k,N1){D1(function(){S.oCRUDManager.callAction({functionImportPath:j.Action,contexts:e,sourceControl:k,label:j.Label,operationGrouping:"",navigationProperty:""}).then(function(O1){if(O1&&O1.length>0){var P1=O1[0];if(P1.response&&P1.response.context&&(!P1.actionContext||P1.actionContext&&P1.response.context.getPath()!==P1.actionContext.getPath())){S.oApplication.getBusyHelper().getUnbusy().then(S.oViewDependencyHelper.setMeToDirty.bind(null,u.getOwnerComponent(),i));}}});},q.noop,N1,"Proceed");},checkToolbarIntentsSupported:L1,getControlInformation:y,executeForAllInformationObjects:z,focusControl:r};}return B.extend("sap.suite.ui.generic.template.lib.CommonUtils",{constructor:function(e,S,i){q.extend(this,s(e,S,i));}});});
