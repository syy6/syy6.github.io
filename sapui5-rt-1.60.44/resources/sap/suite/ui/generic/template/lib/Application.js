sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","sap/ui/core/routing/HistoryDirection","sap/m/MessageToast","sap/m/ActionSheet","sap/m/Dialog","sap/m/Popover","sap/suite/ui/generic/template/lib/deletionHelper","sap/suite/ui/generic/template/lib/routingHelper","sap/suite/ui/generic/template/lib/BeforeSaveHelper","sap/suite/ui/generic/template/lib/ContextBookkeeping","sap/suite/ui/generic/template/lib/StatePreserver","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,D,J,H,a,M,A,b,P,d,r,c,C,S,t){"use strict";var s=(t.testableStatic(function(T,o){var h="sapUiSizeCozy",i="sapUiSizeCompact";if(o.hasClass(h)||o.hasClass(i)){return"";}else{return T?h:i;}},"Application_determineContentDensityClass")(D.support.touch,q(document.body)));function g(){return s;}function f(o,p){q.sap.syncStyleClass(s,p,o);p.addDependent(o);}var f=t.testableStatic(f,"Application_attachControlToParent");function e(T){var o=new C(T.oAppComponent);var l,E;var n=Object.create(null);function h(){return l;}function k(i){l=i;}function m(i){var j=T.oNavigationControllerProxy.getActiveComponents();return j.indexOf(i.getId())>=0;}var I=false;function p(i){T.fnAddSideEffectPromise(i);}function u(i){if(I){return;}var j=q.grep(T.aRunningSideEffectExecutions,function(p1){return!!p1;});if(j.length){I=true;Promise.all(j).then(function(){I=false;u(i);});}else{i();}}function v(i){var j;if(i instanceof b){j="open";}else if(i instanceof P||i instanceof A){j="openBy";}if(j){var p1=i[j];i[j]=function(){var q1=arguments;u(function(){if(!T.oBusyHelper.isBusy()){T.oBusyHelper.getUnbusy().then(function(){p1.apply(i,q1);});}});};}}var F={};function w(i,j,p1,q1,r1){i=i||T.oNavigationHost;var s1=i.getId();var t1=F[s1]||(F[s1]={});var u1=t1[j];if(!u1){u1=sap.ui.xmlfragment(s1,j,p1);f(u1,i);var v1;if(q1){v1=new J();u1.setModel(v1,q1);}(r1||q.noop)(u1,v1);t1[j]=u1;v(u1);}return u1;}function x(){return new Promise(function(i){T.oNavigationObserver.getProcessFinished(true).then(function(){T.oBusyHelper.getUnbusy().then(i);});});}function y(i){T.oShellServicePromise.then(function(j){j.setBackNavigation(i);});}function z(i){if(!T.oFlexibleColumnLayoutHandler){return{handleDataReceived:function(){return false;}};}return T.oFlexibleColumnLayoutHandler.getFclProxyForView(i);}var G=false;function K(i){G=i;}function L(i,j){if(!T.oFlexibleColumnLayoutHandler){return true;}var p1=r.determineNavigationPath(i,j);return T.oFlexibleColumnLayoutHandler.isNewHistoryEntryRequired(p1);}function R(i){T.aStateChangers.push(i);}function N(i){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getTargetAfterCancelPromise(i):Promise.resolve(i);}function O(i,j){j.then(function(){o.adaptAfterObjectDeleted(i);});}function Q(i,j,p1){var q1=T.mEntityTree[i];var r1;if(q1.navigationProperty&&q1.parent){r1=j?q1.entitySet:q1.navigationProperty;}else{r1=i;}if(p1.indexOf(r1)<0){p1.unshift(r1);if(q1.navigationProperty&&q1.parent){Q(q1.parent,j,p1);}}}function U(i,j){var p1=[];Q(i,j,p1);return p1;}function V(j){var p1=U(j);p1.pop();var q1="";var r1="";var s1=[];for(var i=0;i<p1.length;i++){q1=q1+r1+p1[i];s1.push(q1);r1="/";}return s1;}function W(){var i=T.oNavigationControllerProxy.oHashChanger.getHash();var j=i.split("?")[0];var p1=j.split("/");if(p1[0]===""||p1[0]==="#"){p1.splice(0,1);}return p1;}function X(i,j,p1){if(T.oFlexibleColumnLayoutHandler){return T.oFlexibleColumnLayoutHandler.adaptBreadCrumbUrl(i,j,p1);}return i;}function Y(){var j=T.oNavigationControllerProxy.getActiveComponents();var p1=0;var q1;for(var i=0;i<j.length;i++){var r1=T.componentRegistry[j[i]];if(r1.viewLevel>0&&(p1===0||r1.viewLevel<p1)){p1=r1.viewLevel;q1=r1.oComponent;}}var s1=q1?Promise.resolve(q1):T.oNavigationControllerProxy.getRootComponentPromise();return s1.then(function(t1){return t1.getModel("i18n").getResourceBundle();});}function Z(){return T.oNavigationControllerProxy.getAppTitle();}function $(i,j){T.oNavigationControllerProxy.subTitleForViewLevelChanged(i,j);}function _(i){return T.oNavigationControllerProxy.getCurrentKeys(i);}function a1(){for(var i in T.componentRegistry){var j=T.componentRegistry[i];if(j.viewLevel===1){if(m(j.oComponent)){var p1=j.oComponent.getComponentContainer().getElementBinding();return p1&&p1.getPath();}else{return null;}}}return null;}function b1(i){if(i.viewLevel){var j=i.oComponent.getEntitySet();return T.mEntityTree[j];}return T.mRoutingTree.root;}function c1(p1,q1,r1,s1,t1){var u1=b1(r1);var v1=false;var w1;var x1=true;for(var i=0;i<u1.children.length&&!w1;i++){var y1=u1.children[i];var z1=T.mEntityTree[y1];if(z1[r1.viewLevel?"navigationProperty":"sRouteName"]===p1){w1=z1.sRouteName;x1=!z1.noKey;}}if(s1&&!w1){var A1=u1.embeddedComponents[s1];if(A1){for(var j=0;j<A1.pages.length&&!v1;j++){var B1=A1.pages[j];if(B1.navigationProperty===p1){v1=true;var C1=r1.oComponent.getEntitySet();w1=C1+"/"+s1+"/"+p1;x1=!(B1.routingSpec&&B1.routingSpec.noKey);}}}}if(w1){var D1=v1?s1+r.getPatternDelimiter():"";var E1=x1?"("+q1+")":"";var F1=D1+p1+E1;T.oNavigationControllerProxy.navigateToSuffix(F1,r1.viewLevel+1,w1,t1);}}var d1;function e1(j,p1){var i=p1||0;if(i>0){return null;}var q1=j.getEntitySet();var r1=T.mEntityTree[q1];var s1=r1&&r1.communicationObject;for(;i<0&&s1;){r1=T.mEntityTree[r1.parent];if(r1.communicationObject!==s1){i++;s1=r1.communicationObject;}}if(i<0||s1){return s1;}d1=d1||{};return d1;}function f1(i){for(var j in T.mEntityTree){if(T.mEntityTree[j].navigationProperty&&(T.mEntityTree[j].level===i+1)){return T.mEntityTree[j].navigationProperty;}}}function g1(){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getMaxColumnCountInFCL():false;}function h1(){var j=T.oNavigationControllerProxy.getActiveComponents();for(var i=0;i<j.length;i++){var p1=j[i];var q1=T.componentRegistry[p1];var r1=q1.methods.currentDraftModified&&q1.methods.currentDraftModified();if(r1){o.markDraftAsModified(r1);}}}function i1(){if(E!==undefined){return E;}var i,j,p1,q1,r1,s1,t1=true;var u1=T.oAppComponent.getModel();var v1=u1.getMetaModel();var w1=u1.mContexts;for(p1 in w1){t1=false;r1=w1[p1].sPath;q1=r1&&r1.substring(1,r1.indexOf('('));s1=q1&&v1.getODataEntitySet(q1);if(s1){i=u1.getProperty(r1);j=i&&u1.getETag(undefined,undefined,i)||null;if(j){E=true;return E;}}}if(t1){return true;}E=false;return E;}function j1(j){var i,p1,q1;var r1=T.oNavigationControllerProxy.getAllComponents();for(i=0;i<r1.length;i++){p1=r1[i];if(!j||!j[p1]){q1=T.componentRegistry[p1];q1.utils.refreshBinding(true);}}}function k1(i){if(T.oFlexibleColumnLayoutHandler){T.oFlexibleColumnLayoutHandler.setStoredTargetLayoutToFullscreen(i);}}function l1(){T.oPaginatorInfo={};}function m1(i){return new S(T,i);}function n1(i,j){return new c(T,i,j);}function o1(j,p1){var q1=n[j];if(!q1){q1=Object.create(null);n[j]=q1;var r1=T.oAppComponent.getModel();var s1=r1.getMetaModel();var t1=s1.getODataEntitySet(j);var u1=t1&&s1.getODataEntityType(t1.entityType);var v1=(u1&&u1.navigationProperty)||[];for(var i=0;i<v1.length;i++){var w1=v1[i];q1[w1.name]=w1;}}return q1[p1];}T.oApplicationProxy={getDraftSiblingPromise:o.getDraftSiblingPromise,getAlternativeContextPromise:o.getAlternativeContextPromise,getPathOfLastShownDraftRoot:o.getPathOfLastShownDraftRoot,areTwoKnownPathesIdentical:o.areTwoKnownPathesIdentical,getResourceBundleForEditPromise:Y,getHierarchySectionsFromCurrentHash:W,getContentDensityClass:g,setEditableNDC:K,getDialogFragment:w.bind(null,null),destroyView:function(i){delete F[i];},setListReportTable:k,markCurrentDraftAsModified:h1,prepareDeletion:O,performAfterSideEffectExecution:u};return{setEditableNDC:K,getEditableNDC:function(){return G;},getContentDensityClass:g,attachControlToParent:f,getDialogFragmentForView:w,getBusyHelper:function(){return T.oBusyHelper;},addSideEffectPromise:p,performAfterSideEffectExecution:u,isComponentActive:m,showMessageToast:function(){var i=arguments;var j=function(){q.sap.log.info("Show message toast");M.show.apply(M,i);};Promise.all([x(true),T.oBusyHelper.getUnbusy()]).then(j);},setBackNavigation:y,getFclProxyForView:z,isNewHistoryEntryRequired:L,registerStateChanger:R,getDraftSiblingPromise:o.getDraftSiblingPromise,registerContext:o.registerContext,activationStarted:o.activationStarted,cancellationStarted:o.cancellationStarted,editingStarted:o.editingStarted,getTargetAfterCancelPromise:N,getBreadCrumbInfo:V,adaptBreadCrumbUrl:X,getSections:U,getHierarchySectionsFromCurrentHash:W,getAppTitle:Z,subTitleForViewLevelChanged:$,getCurrentKeys:_,getPathForViewLevelOneIfVisible:a1,getCommunicationObject:e1,navigateRoute:c1,getForwardNavigationProperty:f1,getMaxColumnCountInFCL:g1,getListReportTable:h,markCurrentDraftAsModified:h1,checkEtags:i1,refreshAllComponents:j1,getIsDraftModified:o.getIsDraftModified,prepareDeletion:d.prepareDeletion.bind(null,T),prepareDeletionOfCreateDraft:d.prepareDeletionOfCreateDraft.bind(null,T),setStoredTargetLayoutToFullscreen:k1,invalidatePaginatorInfo:l1,getStatePreserver:m1,getBeforeSaveHelper:n1,getNavigationProperty:o1};}return B.extend("sap.suite.ui.generic.template.lib.Application",{constructor:function(T){q.extend(this,e(T));}});});
