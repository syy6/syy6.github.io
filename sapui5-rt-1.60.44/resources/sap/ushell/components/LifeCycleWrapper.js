// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/Config"],function(C){"use strict";var L=function(){this.oInstanceManager={};L.prototype.Init();};L.prototype.Init=function(){this.oManagedComponents={};};L.prototype.processDelay=function(n,c){if(!c||c.delay===undefined){return false;}var m=this.oManagedComponents[n];if(c.delay===0){m.fnRun();return true;}else{m.oTimer=setTimeout(m.fnRun,c.delay);return false;}};L.prototype.processOn=function(n,c){var o;if(c.on){var m=this.oManagedComponents[n],e=sap.ui.getCore().getEventBus();for(o=0;o<c.on.length;o++){var E=c.on[o];e.subscribe(E.sender,E.signal,m.fnRun,this);}}};L.prototype.processLaunchData=function(n){if(!this.oManagedComponents[n]){return;}var c=this.oManagedComponents[n].oConfiguration,l=c.launchData;if(!L.prototype.processDelay(n,l)){L.prototype.processOn(n,l);}};L.prototype.startComponent=function(n,r,c){if(this.oManagedComponents[n]){return;}this.oManagedComponents[n]={sState:'start',fnRun:r,oConfiguration:c,oTimer:undefined};};L.prototype.componentCreated=function(n){if(!this.oManagedComponents[n]){return;}var m=this.oManagedComponents[n],c=this.oManagedComponents[n].oConfiguration;if(m.oTimer){clearTimeout(m.oTimer);}if(c.launchData.on){var M=this.oManagedComponents[n],o,e=sap.ui.getCore().getEventBus();for(o=0;o<c.launchData.on.length;o++){var E=c.launchData.on[o];e.unsubscribe(E.sender,E.signal,M.fnRun,this);}}};L.prototype.createLifeCycleWrapperShell=function(c){var b=true,d=jQuery.Deferred(),r=function(a,f,o){if(!sap.ushell.Container){d.reject();return;}jQuery.sap.registerModulePath(c.run.ui5ComponentName,c.run.url+"/");sap.ushell.Container.getService("Ui5ComponentLoader").createComponent(c.run).done(function(l){L.prototype.componentCreated(c.name);if(o&&(typeof o==="function")){o();}d.resolve(l);}).fail(function(F){d.reject(F);});}.bind(this),e=c.launchData.excludedStates,s;if(e){s=C.last("/core/shell/model/currentState/stateName");if(e.indexOf(s)!=-1){b=false;}}if(b){this.startComponent(c.name,r,c);this.processLaunchData(c.name);}else{d.reject();}return d;};return new L();},true);
