// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(['sap/ushell/components/CatalogsManager','sap/ushell/resources','sap/ui/core/UIComponent','sap/ushell/components/homepage/ComponentKeysHandler','sap/m/routing/Router','sap/ushell/UserActivityLog','sap/ushell/Config','sap/ushell/bootstrap/common/common.load.model',"sap/ushell/components/SharedComponentUtils"],function(C,r,U,a,R,b,c,m,s){"use strict";return U.extend("sap.ushell.components.appfinder.Component",{metadata:{routing:{config:{viewType:"JS",controlAggregation:"detailPages",controlId:"catalogViewMasterDetail",clearAggregation:false,routerClass:R,async:true},routes:[]},version:"1.60.40",library:"sap.ushell.components.flp",dependencies:{libs:["sap.m"]},config:{semanticObject:'Shell',action:'home',title:r.i18n.getText("homeBtn_tooltip"),fullWidth:true,hideLightBackground:true}},parseOldCatalogParams:function(u){var p=jQuery.sap.getUriParameters(u).mParams,v,k;for(k in p){if(p.hasOwnProperty(k)){v=p[k][0];p[k]=v.indexOf('/')!==-1?encodeURIComponent(v):v;}}return p;},handleNavigationFilter:function(n){var S=sap.ushell.Container.getService("URLParsing").parseShellHash(n),p;if(S&&S.semanticObject==='shell'&&S.action==='catalog'){p=this.parseOldCatalogParams(n);setTimeout(function(){this.getRouter().navTo("catalog",{filters:JSON.stringify(p)});}.bind(this),0);return this.oShellNavigation.NavigationFilterStatus.Abandon;}return this.oShellNavigation.NavigationFilterStatus.Continue;},createContent:function(){this.oRouter=this.getRouter();this.isEmbedded=!sap.ushell.Container.isMock;this.oModel=m.getModel();this.setModel(this.oModel);var h,S,p,o,P=c.last("/core/shell/enablePersonalization");if(P){this.oRouter.addRoute({name:"userMenu",pattern:"userMenu/:filters:"});this.oRouter.addRoute({name:"sapMenu",pattern:"sapMenu/:filters:"});this.oRouter.addRoute({name:"catalog",pattern:["catalog/:filters:","",":filters:"]});s.getEffectiveHomepageSetting("/core/home/homePageGroupDisplay","/core/home/enableHomePageSettings");}var d={model:this.oModel,router:this.oRouter};this.oCatalogsManager=new C("dashboardMgr",d);this.setModel(r.i18nModel,"i18n");s.toggleUserActivityLog();this.oShellNavigation=sap.ushell.Container.getService("ShellNavigation");h=hasher.getHash();S=sap.ushell.Container.getService("URLParsing").parseShellHash(h);if(S&&S.semanticObject==='shell'&&S.action==='catalog'){p=this.parseOldCatalogParams(h);o=this.getMetadata().getConfig();this.oShellNavigation.toExternal({target:{semanticObject:o.semanticObject,action:o.action}});this.getRouter().navTo("catalog",{filters:JSON.stringify(p)});}var A=sap.ui.view({id:"appFinderView",viewName:"sap.ushell.components.appfinder.AppFinder",type:"JS",async:true});return A;},exit:function(){this.oCatalogsManager.destroy();m.unsubscribeEventHandlers();}});});
