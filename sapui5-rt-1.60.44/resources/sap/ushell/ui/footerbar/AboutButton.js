// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(['sap/m/Button','sap/m/Dialog','sap/m/ObjectHeader','sap/m/VBox','sap/ui/layout/form/SimpleForm','sap/ushell/library','sap/ushell/resources','sap/ushell/ui/launchpad/ActionItem','sap/ushell/services/AppConfiguration','sap/m/Label','sap/m/Text','sap/ushell/utils/type',"sap/base/Log","sap/ui/VersionInfo",'./AboutButtonRenderer'],function(B,D,O,V,S,l,r,A,a,L,T,t,b,c){"use strict";var d=A.extend("sap.ushell.ui.footerbar.AboutButton",{metadata:{library:"sap.ushell"}});d.prototype.init=function(){if(A.prototype.init){A.prototype.init.apply(this,arguments);}this.setIcon('sap-icon://hint');this.setText(r.i18n.getText("about"));this.setTooltip(r.i18n.getText("about"));this.attachPress(this.showAboutDialog);};d.prototype.showAboutDialog=function(){return this._getUI5VersionInfo().then(function(v){var e=r.i18n,o=v||{},m=a.getMetadata(),f=sap.ushell.Container.getService("AppLifeCycle").getCurrentApplication(),s=new S({id:'aboutDialogFormID',editable:false,layout:sap.ui.layout.form.SimpleFormLayout.ResponsiveGridLayout,content:[new L({text:e.getText("technicalName")}),new T({text:m.technicalName||''}),new L({text:e.getText("fioriVersionFld")}),new T({text:m.version||''}),new L({text:e.getText("sapui5Fld")}),new T({text:(o.version||"")+(' ('+(o.buildTimestamp||"")+')')||''}),new L({text:e.getText("userAgentFld")}),new T({text:navigator.userAgent||''}),new L({text:''})]}),h=new O({title:m.title,icon:m.icon}).addStyleClass('sapUshellAboutDialogHeader'),g,i,j=new B({text:e.getText("okBtn"),press:function(){g.close();}});if(f){f.getTechnicalParameter("sap-fiori-id").then(function(F){if(t.isArray(F)&&F[0]){s.addContent(new L({text:e.getText("fioriAppId")}));s.addContent(new T({text:F[0]}));}},function(E){jQuery.sap.log.error("Cannot get technical parameter 'sap-fiori-id'",E,"sap.ushell.ui.footerbar.AboutButton");});f.getTechnicalParameter("sap-ach").then(function(k){if(t.isArray(k)&&k[0]){s.addContent(new L({text:e.getText("sapAch")}));s.addContent(new T({text:k[0]}));}},function(E){jQuery.sap.log.error("Cannot get technical parameter 'sap-ach'",E,"sap.ushell.ui.footerbar.AboutButton");});}if(jQuery.isEmptyObject(m)||!m.icon){i=new V({items:[s]});}else{i=new V({items:[h,s]});}g=new D({id:"aboutContainerDialogID",title:e.getText("about"),contentWidth:"25rem",horizontalScrolling:false,leftButton:j,afterClose:function(){g.destroy();}});g.addContent(i);g.open();}.bind(this));};d.prototype._getUI5VersionInfo=function(){return new Promise(function(e){c.load().then(e).catch(function(){b.error("VersionInfo could not be loaded");e({});});});};return d;},true);
