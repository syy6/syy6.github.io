sap.ui.define(["jquery.sap.global","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ovp/cards/CommonUtils","sap/ui/model/odata/AnnotationHelper","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/model/analytics/odata4analytics","sap/ui/vbm/library","sap/ui/generic/app/navigation/service/SelectionVariant","sap/ovp/app/resources"],function(q,N,D,C,O,F,a,o,V,S,b){"use strict";var f={count:0};var c={};var d={};var e={};var g={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};var A={TEXT:"com.sap.vocabularies.Common.v1.Text",TEXT_ARRANGEMENT:"com.sap.vocabularies.UI.v1.TextArrangement"};var T={TEXT_LAST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast",TEXT_FIRST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst",TEXT_ONLY:"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly",TEXT_SEPARATE:"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"};var I={"List_condensed":{phone:5,tablet:5,desktop:5},"List_extended":{phone:3,tablet:3,desktop:3},"List_condensed_bar":{phone:5,tablet:5,desktop:5},"List_extended_bar":{phone:3,tablet:3,desktop:3},"Table":{phone:5,tablet:5,desktop:5},"Stack_simple":{phone:20,tablet:20,desktop:20},"Stack_complex":{phone:5,tablet:5,desktop:5}};function h(i,j){var k=j.Longitude.Path;var _2=j.Latitude.Path;return"{path:'"+k+"'}; {path:'"+_2+"'}"+";0";}h.requiresIContext=true;function l(i,j){return"{path:'"+j.CountryCode.Path+"'}";}l.requiresIContext=true;function m(i,j){var k=j.Criticality.Path;return"{path:'"+k+"', formatter: 'sap.ovp.cards.AnnotationHelper.getCriticalityStateFromValue' }";}m.requiresIContext=true;function n(i){var j;switch(i){case"0":j=V.SemanticType.Default;break;case"1":j=V.SemanticType.Error;break;case"2":j=V.SemanticType.Warning;break;case"3":j=V.SemanticType.Success;break;default:j=V.SemanticType.None;break;}return j;}function p(i,j){var k=i.getSetting('ovpCardProperties');var _2=k.getProperty('/showLabelText');if(_2==="true"){var a3=j.Address[0];if(typeof a3.country!=="undefined"){return"{path:'"+a3.country.Path+"'}";}else if(typeof a3.locality!=="undefined"){return"{path:'"+a3.locality.Path+"'}";}else if(typeof a3.street!=="undefined"){return"{path:'"+a3.street.Path+"'}";}else if(typeof a3.code!=="undefined"){return"{path:'"+a3.code.Path+"'}";}}else{return null;}}p.requiresIContext=true;function r(i,j){if(!j){return"";}if(j.Label){return j.Label.String;}var k=i.getSetting&&i.getSetting('ovpCardProperties');var _2=k&&k.getProperty("/metaModel");var a3=k&&k.getProperty("/entityType");if(!_2||!a3){return"";}var b3;if(j.Value){b3=j.Value.Path;}if(j.Target){var c3=K(a3.$path,j);var d3=c3&&_2.getProperty(c3);b3=d3&&d3.Value.Path;}if(!b3||!b3.length>0||b3===" "){return"";}var e3=_2.getODataProperty(a3,b3);if(!e3){return"";}var f3=e3["sap:label"]||(e3["com.sap.vocabularies.Common.v1.Label"]||"").String||"";return f3;}r.requiresIContext=true;function s(i,k){if(i.getSetting){var j=i.getSetting("_ovpCache");if(j){return j[k];}}return undefined;}function t(i,k,j){if(i.getSetting){var _2=i.getSetting("_ovpCache");if(_2){_2[k]=j;}}}function u(i,j){if(!f[j]){f[j]=0;}f[j]++;var k=j+f[j];f[k]=i;return"sap.ovp.cards.AnnotationHelper.formatFunctions."+k;}function v(i,j){var k;if(j){k=j.None;if(i&&i.EnumMember){var _2=i.EnumMember;if(x(_2,'Negative')){k=j.Negative;}else if(x(_2,'Critical')){k=j.Critical;}else if(x(_2,'Positive')){k=j.Positive;}}}return k;}function w(i){if(i=="Error"){i=1;}else if(i=="Warning"){i=2;}else if(i=="Success"){i=3;}else{i=0;}return i;}function x(i,j){return i&&i.indexOf(j,i.length-j.length)!==-1;}function y(i,j,k,_2,a3,b3,c3){var d3={};d3.EnumMember="None";var e3=Number.NEGATIVE_INFINITY;var f3=Number.POSITIVE_INFINITY;if((!a3&&a3!==0)&&(k||k===0)){a3=k;}if((!b3&&b3!==0)&&(_2||_2===0)){b3=_2;}if(!k&&k!==0){k=e3;}if(!_2&&_2!==0){_2=f3;}if(i!==undefined){i=Number(i);if(x(j,"Minimize")||x(j,"Minimizing")){if((b3||b3===0)&&(_2||_2===0)){if(i<=parseFloat(b3)){d3.EnumMember="Positive";}else if(i>parseFloat(_2)){d3.EnumMember="Negative";}else{d3.EnumMember="Critical";}}}else if(x(j,"Maximize")||x(j,"Maximizing")){if((a3||a3===0)&&(k||k===0)){if(i>=parseFloat(a3)){d3.EnumMember="Positive";}else if(i<parseFloat(k)){d3.EnumMember="Negative";}else{d3.EnumMember="Critical";}}}else if(x(j,"Target")){if((b3||b3===0)&&(_2||_2===0)&&(a3||a3===0)&&(k||k===0)){if(i>=parseFloat(a3)&&i<=parseFloat(b3)){d3.EnumMember="Positive";}else if(i<parseFloat(k)||i>parseFloat(_2)){d3.EnumMember="Negative";}else{d3.EnumMember="Critical";}}}}return v(d3,c3);}function z(i,j,k,_2){if(!i||!j){return;}i=Number(i);if(!_2&&(i-j>=0)){return"sap-icon://trend-up";}if(!k&&(i-j<=0)){return"sap-icon://trend-down";}if(j&&_2&&(i-j>=_2)){return"sap-icon://trend-up";}if(j&&k&&(i-j<=k)){return"sap-icon://trend-down";}}function B(i,j){var k=i.getPath(0)+"-DataFields-Sorted";var _2=s(i,k);if(!_2){var a3=E(i,j);var b3=a3.map(function(c3){return c3.Value.Path;});b3=b3.filter(function(c3){return!!c3;});_2=j.filter(function(c3){if(c3.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&b3.indexOf(c3.Value.Path)===-1){return true;}return false;});_2=M(_2);t(i,k,_2);}return _2;}B.requiresIContext=true;function E(j,k,_2){var a3=j.getPath(0)+"-DataPoints-Sorted";var b3=s(j,a3);if(!b3){if(_2){b3=k.filter(H);}else{b3=k.filter(G);}b3=M(b3);var c3;for(var i=0;i<b3.length;i++){c3=j.getPath(0).substr(0,j.getPath(0).lastIndexOf("/")+1);b3[i]=j.getModel(0).getProperty(K(c3,b3[i]));c3="";}t(j,a3,b3);}return b3;}E.requiresIContext=true;function G(i){if(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/)){return true;}return false;}function H(i){if((i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/))||(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.Communication.v1.Contact.*/))){return true;}return false;}function J(i){if(!i||!i.Criticality||!i.Criticality.Path){return;}return"{path:'"+i.Criticality.Path+"'}";}function K(i,j){if(i&&!x(i,'/')){i+='/';}return i+j.Target.AnnotationPath.slice(1);}function L(i){var j,k;if(i["com.sap.vocabularies.UI.v1.Importance"]){j=i["com.sap.vocabularies.UI.v1.Importance"].EnumMember;switch(j){case"com.sap.vocabularies.UI.v1.ImportanceType/High":k=1;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":k=2;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Low":k=3;break;}}else{k=4;}return k;}function M(i){if(i.length<2){return i;}var j=parseInt(i.length/2,10);var k=i.slice(0,j);var _2=i.slice(j,i.length);return P(M(k),M(_2));}function P(i,j){var k=[];while(i.length&&j.length){var _2=L(i[0]),a3=L(j[0]);if(_2<=a3){k.push(i.shift());}else{k.push(j.shift());}}while(i.length){k.push(i.shift());}while(j.length){k.push(j.shift());}return k;}function Q(i,j,k){var _2=B(i,j)[k];if(_2){return $(i,_2);}return"";}function R(i,j,k){var _2=B(i,j)[k];return r(i,_2);}function U(i,j,k){var _2=E(i,j)[k];if(_2&&_2.Title){return _2.Title.String;}return"";}function W(i,j,k){var _2=j.filter(G);_2=M(_2);if(!_2||!_2.length||!_2.length>0){return"";}return r(i,_2[0]);}function X(i,j,k,_2){var a3=E(i,j)[k];if(!a3){return"";}var b3=i.getSetting('ovpCardProperties');var c3=b3.getProperty("/entityType");var d3=b3.getProperty("/metaModel");return _(i,a3,c3,d3,_2);}function Y(i,j,k){var _2=E(i,j)[k];if(_2&&_2.Criticality){return true;}}function Z(i,j,k){var _2=E(i,j)[k];var a3=_2.Criticality.Path;return"{path:'"+a3+"'}";}function _(i,j,k,_2,a3){if(!j||!j.Value){return"";}var b3=i.getSetting('ovpCardProperties');var c3=false;if(b3){var d3=b3.getProperty("/ignoreSapText");c3=d3==undefined?c3:d3;}var e3=_2.getODataProperty(k,j.Value.Path);var f3=false;if(c3==true){if(e3&&(e3["com.sap.vocabularies.Analytics.v1.Measure"]||e3["sap:aggregation-role"]=="measure")){f3=true;}}if(!f3&&e3){var g3;if(e3["com.sap.vocabularies.Common.v1.Text"]){g3=e3["com.sap.vocabularies.Common.v1.Text"].String?e3["com.sap.vocabularies.Common.v1.Text"].String:e3["com.sap.vocabularies.Common.v1.Text"].Path;}else if(e3["sap:text"]){g3=e3["sap:text"];}if(g3){e3=_2.getODataProperty(k,g3);j={Value:{Path:e3.name}};}}return $(i,j,a3);}function $(i,j,k,_2){if(j.Value.Apply){return O.format(i,j.Value);}var a3=i.getSetting('ovpCardProperties');var b3=a3.getProperty("/entityType");var c3=a3.getProperty("/metaModel");return b1(i,j,b3,c3,k,_2);}$.requiresIContext=true;function a1(i,j,k,_2){if((!k)||(typeof _2!=='string')){return _2;}var a3=k[A.TEXT];if(!a3){return _2;}var b3,c3;b3=k[A.TEXT_ARRANGEMENT];c3=b3&&b3.EnumMember;if(!c3){b3=a3&&a3[A.TEXT_ARRANGEMENT];c3=b3&&b3.EnumMember;}if(!c3){b3=j&&j[A.TEXT_ARRANGEMENT];c3=b3&&b3.EnumMember;}if(!c3){return _2;}var d3=O.format(i,a3);if(!d3||d3===" "){return _2;}var e3;switch(c3){case T.TEXT_FIRST:e3=d3+" ("+_2+")";break;case T.TEXT_LAST:e3=_2+" ("+d3+")";break;case T.TEXT_ONLY:e3=d3;break;case T.TEXT_SEPARATE:e3=_2+" ("+d3+")";break;default:e3=_2;break;}return e3;}function b1(j,k,_2,a3,b3,c3,d3){if(k.Value.Apply){return O.format(j,k.Value);}var e3=k.Value.Path?k.Value.Path:k.Value.String;var f3=a3.getODataProperty(_2,e3),g3="",h3;var i3=j.getSetting("ovpCardProperties");var j3=i3&&i3.getProperty("/contentFragment");if(!c3){if(k.Value.Path&&k.Value.Path.split("/").length>1){f3=i1(a3,_2,k.Value.Path);}if(!f3){return"";}if(f3["type"]==='Edm.DateTime'||f3["type"]==='Edm.DateTimeOffset'){var k3=i3&&i3.getProperty("/showDateInRelativeFormat");h3=f1("dateFormatFunction",k3,f3["type"]==='Edm.DateTime'?true:false);g3=c1([k.Value.Path?k.Value.Path:f3.name],h3);}else if((k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)||f3["scale"]){var l3=(k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)?k.ValueFormat.NumberOfFractionalDigits.Int:0,m3;var n3=(k.ValueFormat&&k.ValueFormat.ScaleFactor&&k.ValueFormat.ScaleFactor.Decimal);if(f3["Org.OData.Measures.V1.ISOCurrency"]){m3=f3["Org.OData.Measures.V1.ISOCurrency"].Path?f3["Org.OData.Measures.V1.ISOCurrency"].Path:f3["Org.OData.Measures.V1.ISOCurrency"].String;}else if(f3["Org.OData.Measures.V1.Unit"]){m3=f3["Org.OData.Measures.V1.Unit"].Path?f3["Org.OData.Measures.V1.Unit"].Path:f3["Org.OData.Measures.V1.Unit"].String;}else if(f3["sap:unit"]){m3=f3["sap:unit"];}var o3=m3?a3.getODataProperty(_2,m3):null,p3=[k.Value.Path?k.Value.Path:f3.name];if(l3>2){l3=2;}if(f3["Org.OData.Measures.V1.ISOCurrency"]){var q3=f3["Org.OData.Measures.V1.ISOCurrency"];if(q3.Path){h3=g1(l3,n3);p3.push(q3.Path);}else if(q3.String){h3=g1(l3,n3,q3.String);}}else if(o3&&(o3["Org.OData.Measures.V1.ISOCurrency"]||o3["sap:semantics"]==="currency-code")){h3=g1(l3,n3);p3.push(m3);}else{h3=d1(l3,n3);}g3=c1(p3,h3);}else{if(d3){g3=O.simplePath(j,k.Value);}else{var r3=O.format(j.getModel()?j:j.getInterface(0),k.Value);var s3=r3.split(",");var t3=[];if(s3.length>1){for(var i=0;i<s3.length;i++){if(s3[i].indexOf("path:")>=0||s3[i].indexOf("type:")>=0){t3.push(s3[i]);}}if(t3.length>0){g3=g3+t3.join(',');if(g3.substring(g3.length-1)!=="}"){g3=g3+"}";}}}else{g3=r3;}}}if(j3){g3=a1(j,_2,f3,g3);}if(f3["Org.OData.Measures.V1.Unit"]){var u3=f3["Org.OData.Measures.V1.Unit"];if(u3.Path){g3+=(" "+c1([u3.Path]));}else if(u3.String){if(u3.String!=="%"){g3+=" ";}g3+=u3.String;}}}if(!b3){if(f3["Org.OData.Measures.V1.ISOCurrency"]){var q3=f3["Org.OData.Measures.V1.ISOCurrency"];if(q3.Path){g3+=(" "+c1([q3.Path]));}else if(q3.String){g3+=(" "+q3.String);}}}if(g3[0]===" "){g3=g3.substring(1);}return g3;}function c1(j,k){var _2="",a3=j.length;if(a3>1){_2="{parts:[";for(var i=0;i<a3;i++){_2+=("{path: '"+j[i]+"'}"+((i===a3-1)?"]":", "));}}else{_2="{path: '"+j[0]+"'";}_2+=(k?(", formatter: '"+k+"'"):"")+"}";return _2;}function d1(i,j){var k="formatNumberCalculation_"+(j?i+"_"+j:i);if(!c[k]){c[k]=e1(Number(i),j);}return"sap.ovp.cards.AnnotationHelper.NumberFormatFunctions."+k;}function e1(i,j){return function(k){var _2=N.getFloatInstance({style:'short',showMeasure:false,shortRefNumber:j,minFractionDigits:i,maxFractionDigits:i});return _2.format(Number(k));};}function f1(i,j,k){var _2={'relative':true,'relativeScale':'auto'};if(j!==undefined&&!j){_2={'style':'medium'};}if(!d[i]){d[i]=function(a3){var b3=D.getInstance(_2);if(!a3){a3="";return a3;}return b3.format(new Date(a3),k);};}return"sap.ovp.cards.AnnotationHelper.DateFormatFunctions."+i;}function g1(i,j,k){var _2=j?i+"_"+j:i;var a3="formatCurrencyCalculation_"+(k?k+"_"+_2:_2);if(!e[a3]){e[a3]=h1(i,j,k);}return"sap.ovp.cards.AnnotationHelper.CurrencyFormatFunctions."+a3;}function h1(i,j,k){return function(_2,a3){var b3="";var c3=N.getCurrencyInstance({style:'short',showMeasure:false,shortRefNumber:j,minFractionDigits:i,maxFractionDigits:i});if(a3){b3=c3.format(_2,a3);}else{b3=k?c3.format(_2,k):c3.format(_2);}return b3;};}function i1(j,k,_2){var a3=_2.split("/");if(a3.length>1){for(var i=0;i<(a3.length-1);i++){var b3=j.getODataAssociationEnd(k,a3[i]);if(b3){k=j.getODataEntityType(b3.type);}}return j.getODataProperty(k,a3[a3.length-1]);}}function j1(i,j,k){var _2=E(i,j);var a3=g.StateValues;var b3=_2[k];if(!b3){return a3.None;}if(b3.Criticality){return n1(i,b3,a3);}return p1(i,b3,a3);}function k1(i,j,k){var _2=E(i,j);if(_2&&_2.length){var a3=_2[0];if(a3&&(a3.Criticality||a3.CriticalityCalculation)){return true;}}return false;}function l1(i,j,k){if(k1(i,j,k)){return'';}return'#5cbae6';}l1.requiresIContext=true;function m1(i,j,k){var _2=E(i,j),a3=g.ColorValues;var b3=a3.None;if(_2.length>k){var c3=_2[k];if(c3&&c3.Criticality){b3=n1(i,c3,a3);}else{b3=p1(i,c3,a3);}}return b3;}function n1(i,j,k){var _2=k.None;var a3;var b3=j.Criticality;if(b3){a3="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+k.Negative+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Critical'') || ({0} === ''2'') || ({0} === 2) ? ''"+k.Critical+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+k.Positive+"'' : "+"''"+k.None+"'' '}'";if(b3.Path){var c3='$'+O.simplePath(i,b3);_2=q.sap.formatMessage(a3,c3);}else if(b3.EnumMember){var d3="'"+b3.EnumMember+"'";_2=q.sap.formatMessage(a3,d3);}else{q.sap.log.warning("Case not supported, returning the default Neutral state");}}else{q.sap.log.warning("Case not supported, returning the default Neutral state");}return _2;}function o1(i,j,k){var _2=E(i,j);var a3="None";if(_2.length>k){var b3=_2[k];if(b3&&b3.Criticality&&b3.Criticality.Path){a3=Z(i,j,k);}else{a3=p1(i,b3,g.StateValues);a3=w(a3);}}return a3;}function p1(i,j,k){var _2=k.None;if(j.Criticality){_2=v(j.Criticality,k);}else if(j.CriticalityCalculation&&j.Value&&j.Value&&j.Value.Path){_2=q1(i,j,k);}return _2;}function q1(i,j,k){var _2=G1(j.Value);var a3=j.CriticalityCalculation.ImprovementDirection.EnumMember;var b3=G1(j.CriticalityCalculation.DeviationRangeLowValue);var c3=G1(j.CriticalityCalculation.DeviationRangeHighValue);var d3=G1(j.CriticalityCalculation.ToleranceRangeLowValue);var e3=G1(j.CriticalityCalculation.ToleranceRangeHighValue);var f3=r1(b3);var g3=r1(c3);var h3=r1(d3);var i3=r1(e3);var j3="parts: ["+_2;j3+=f3?","+b3:"";j3+=g3?","+c3:"";j3+=h3?","+d3:"";j3+=i3?","+e3:"";j3+="]";var k3=function(){var m3=1;return y(arguments[0],a3,f3?arguments[m3++]:b3,g3?arguments[m3++]:c3,h3?arguments[m3++]:d3,i3?arguments[m3++]:e3,k);};var l3=u(k3,"formatCriticalityCalculation");return"{"+j3+", formatter: '"+l3+"'}";}function r1(i){return(typeof i==="string")&&i.charAt(0)==="{";}function s1(j,k,_2){var a3="";var b3=_2.split("/");if(b3.length>1){for(var i=0;i<(b3.length-1);i++){var c3=j.getODataAssociationEnd(k,b3[i]);if(c3){k=j.getODataEntityType(c3.type);if(a3){a3=a3+"/";}a3=a3+b3[i];}else{return a3;}}}return a3;}function t1(j,k){var _2=j.getSetting('ovpCardProperties');var a3=_2.getProperty("/addODataSelect");var b3=_2.getProperty("/metaModel");var c3=b3.getODataEntityType(k.entityType);var d3=c3[_2.getProperty('/selectionAnnotationPath')];var e3=c3[_2.getProperty('/presentationAnnotationPath')];var f3="/"+k.name;var g3=Array.prototype.slice.call(arguments,2);var h3=j.getSetting('ovpCardProperties'),i3=h3.getProperty('/parameters');if(d3||!!i3){if((d3&&d3.Parameters&&d3.Parameters.length>0)||!!i3){f3=y2(j.getSetting('dataModel'),k,d3,i3);}}if(_2.getProperty("/cardLayout")&&_2.getProperty("/cardLayout/noOfItems")){var j3="{path: '"+f3+"', length: "+ +(_2.getProperty("/cardLayout/noOfItems"));}else{var j3="{path: '"+f3+"', length: "+H1(_2);}var k3=[];if(a3){k3=v1(j,b3,c3,g3);var l3=_2.getProperty("/template");if(l3!="sap.ovp.cards.charts.analytical"&&l3!="sap.ovp.cards.charts.smart.chart"){var m3=y1(e3);for(var i=0;i<m3.length;i++){if(k3.indexOf(m3[i])===-1){k3.push(m3[i]);}}}}var n3=u1(b3,c3,g3);if(k3.length>0||n3.length>0){j3=j3+", parameters: {";if(k3.length>0){j3=j3+"select: '"+k3.join(',')+"'";}if(n3.length>0){if(k3.length>0){j3=j3+", ";}j3=j3+"expand: '"+n3.join(',')+"'";}j3=j3+"}";}var o3=x1(_2,e3);if(o3.length>0){j3=j3+", sorter:"+JSON.stringify(o3);}var p3=C1(_2,d3);if(p3.length>0){j3=j3+", filters:"+JSON.stringify(p3);}j3=j3+"}";return j3;}t1.requiresIContext=true;function u1(k,_2,a3){var b3=[];var c3,d3,e3,f3;for(var i=0;i<a3.length;i++){if(!a3[i]){continue;}c3=_2.$path+"/"+a3[i];d3=k.createBindingContext(c3);e3=d3.getObject();e3=e3?e3:[];for(var j=0;j<e3.length;j++){if(e3[j].Value&&e3[j].Value.Path){f3=s1(k,_2,e3[j].Value.Path);if(f3&&b3.indexOf(f3)===-1){b3.push(f3);}}}}return b3;}function v1(_2,a3,b3,c3){var d3=[];var e3,f3,g3;for(var i=0;i<c3.length;i++){if(!c3[i]){continue;}e3=b3.$path+"/"+c3[i];f3=a3.createBindingContext(e3);var h3={};if(_2&&_2.bDummyContext){q.extend(h3,_2,f3,true);}else{h3=_2;}g3=f3.getObject();if(!g3){g3=[];}else if(q.isPlainObject(g3)){if(g3.Data){g3=g3.Data;}else{g3=[];}}var i3;var j3;var k3;var l3;for(var j=0;j<g3.length;j++){j3=[];i3=g3[j];k3="";l3=i3.RecordType;if(l3==="com.sap.vocabularies.UI.v1.DataField"){k3=b1(h3,i3,b3,a3,undefined,undefined,true);}else if(l3==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var m3=K(b3.$path,i3);k3=_(h3,a3.getProperty(m3),b3,a3);var n3=J(a3.getProperty(m3));if(n3&&n3.length>0){k3+=n3;}}else if(l3==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"&&i3.Url){var o3;if(!i3.Url.UrlRef){o3=O.format(h3,i3.Url);}if(o3&&o3.substring(0,2)==="{="){k3=o3;}}if(k3){var p3=O.simplePath(h3,i3.Value);if(k3.indexOf("(")<0&&k3!==p3){k3=[].concat(p3,k3).join(" ");}j3=w1(k3);}if(j3&&j3.length>0){var q3;for(var k=0;k<j3.length;k++){q3=j3[k];if(!d3[q3]){d3[q3]=true;var r3=C.getUnitColumn(q3,b3);if(r3&&r3!==q3){d3[r3]=true;}var s3=Z2(a3,b3,q3);if(s3&&s3!==q3){d3[s3]=true;}}}}}}return Object.keys(d3);}function w1(j){var i,k=0,_2=j.length,a3="",b3;for(i=0;i<_2;i++){b3=j.charAt(i);if(!b3){return;}switch(b3){case"{":k++;break;case"}":k--;break;default:if(k<=0){continue;}break;}a3+=b3;}j=a3;var c3=/\${([a-zA-Z0-9\_|\/]*)/g;var d3=/[^[{]*[a-zA-Z0-9\_]/g;var e3=/path *\: *\'([a-zA-Z0-9\_]+)*\'/g;var f3,g3,h3=[];if(j.indexOf("{parts:[")!==-1){j=j.replace("{parts:[","");}if(j.substring(0,2)==="{="){f3=c3;g3=1;}else if(j.indexOf("path")!==-1){var i3=d3.exec(j);while(i3){if(i3[0].indexOf("path")===-1&&i3[0].indexOf("@i18n")!==0){h3.push(i3[0]);}i3=d3.exec(j);}f3=e3;g3=1;}else{f3=d3;g3=0;}var j3=f3.exec(j);while(j3){if(j3[g3]&&j3[g3].indexOf("@i18n")!==0){h3.push(j3[g3]);}j3=f3.exec(j);}return h3;}function x1(j,k){var _2=[];var a3,b3;var c3=j.getProperty("/sortBy");if(c3){var d3=j.getProperty('/sortOrder');if(d3&&d3.toLowerCase()!=='descending'){b3=false;}else{b3=true;}a3={path:c3,descending:b3};_2.push(a3);}var e3=k&&k.SortOrder||undefined;var f3,c3;if(e3){for(var i=0;i<e3.length;i++){f3=e3[i];c3=f3.Property.PropertyPath;b3=D1(f3.Descending,true);a3={path:c3,descending:b3};_2.push(a3);}}return _2;}function y1(j){var k=[];var _2=j&&j.RequestAtLeast||undefined;if(_2){for(var i=0;i<_2.length;i++){k.push(_2[i].PropertyPath);}}return k;}function z1(i){var j=i.getProperty('/entityType');var k=j[i.getProperty('/selectionAnnotationPath')];return{filters:C1(i,k),parameters:B1(k)};}function A1(j){if(!j){return;}var k=j.getProperty('/entityType');var _2=k[j.getProperty('/presentationAnnotationPath')];var a3=x1(j,_2);var b3=[];var i,c3=a3.length;for(i=0;i<c3;i++){if(!a3[i].path){continue;}b3.push({Property:a3[i].path,Descending:a3[i].descending});}if(b3.length>0){return{SortOrder:b3};}}function B1(j){var k,_2=[];if(!j||!j.Parameters){return _2;}var a3=j.Parameters.length;for(var i=0;i<a3;i++){k=j.Parameters[i];if(!k.PropertyName||!k.PropertyName.PropertyPath){continue;}if(!k.PropertyValue){q.sap.log.error("Missing value for parameter "+k.PropertyName.PropertyPath);continue;}_2[_2.length]={path:k.PropertyName.PropertyPath,value:F1(k.PropertyValue)};}return _2;}function C1(k,_2){var a3=[];var b3;var c3=k.getProperty("/filters");if(c3){a3=a3.concat(c3);}if(_2&&_2.SelectOptions){b3=_2.SelectOptions;}else{b3=_2;}var d3,e3,f3;if(b3){for(var i=0;i<b3.length;i++){d3=b3[i];e3=d3.PropertyName.PropertyPath;for(var j=0;j<d3.Ranges.length;j++){f3=d3.Ranges[j];if(f3.Sign.EnumMember){var g3={path:e3,operator:f3.Option.EnumMember.split("/")[1],value1:F1(f3.Low),value2:F1(f3.High),sign:f3.Sign.EnumMember==="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"?"I":"E"};if(g3.sign==="E"&&g3.operator!==F.EQ){q.sap.log.error("Exclude sign is supported only with EQ operator");continue;}if(g3.sign==="E"&&g3.operator===F.EQ){g3.operator=F.NE;g3.sign="I";}if(g3.operator==="CP"&&g3.sign==="I"){var h3=F.Contains;var i3=g3.value1;if(i3){var j3=i3.indexOf('*');var k3=i3.lastIndexOf('*');if(j3>-1){if((j3===0)&&(k3!==(i3.length-1))){h3=F.EndsWith;i3=i3.substring(1,i3.length);}else if((j3!==0)&&(k3===(i3.length-1))){h3=F.StartsWith;i3=i3.substring(0,i3.length-1);}else{i3=i3.substring(1,i3.length-1);}}}g3.operator=h3;g3.value1=i3;}a3.push(g3);}}}}return a3;}function D1(i,j){if(i&&i.Boolean){if(i.Boolean.toLowerCase()==="true"){return true;}else if(i.Boolean.toLowerCase()==="false"){return false;}}else if(i&&i.Bool){if(i.Bool.toLowerCase()==="true"){return true;}else if(i.Bool.toLowerCase()==="false"){return false;}}return j;}function E1(i){var j;if(i){if(i.String){j=Number(i.String);}else if(i.Int){j=Number(i.Int);}else if(i.Decimal){j=Number(i.Decimal);}else if(i.Double){j=Number(i.Double);}else if(i.Single){j=Number(i.Single);}}return j;}function F1(i){var j;if(i){if(i.String||i.String===""){j=i.String;}else if(i.Boolean||i.Bool){j=D1(i);}else if(i.DateTime){j=i.DateTime;}else if(i.DateTimeOffset){j=i.DateTimeOffset;}else{j=E1(i);}}return j;}function G1(i){if(i){if(i.Path){return"{path:'"+i.Path+"'}";}else{return F1(i);}}else{return"";}}function H1(i){var j=i.getProperty('/contentFragment');var k=i.getProperty('/listType');var _2=i.getProperty('/listFlavor');var a3;var b3="desktop";if(a.system.phone){b3="phone";}else if(a.system.tablet){b3="tablet";}if(j=="sap.ovp.cards.list.List"){if(k=="extended"){if(_2=="bar"){a3=I["List_extended_bar"];}else{a3=I["List_extended"];}}else if(_2=="bar"){a3=I["List_condensed_bar"];}else{a3=I["List_condensed"];}}else if(j=="sap.ovp.cards.table.Table"){a3=I["Table"];}else if(j=="sap.ovp.cards.stack.Stack"){if(i.getProperty('/objectStreamCardsNavigationProperty')){a3=I["Stack_complex"];}else{a3=I["Stack_simple"];}}if(a3){return a3[b3];}return 5;}function I1(i){var j=i.getObject();var k=E(i,j,true);var _2=k.map(function(a3){if(a3&&a3.Value&&a3.Value.Path){return a3.Value.Path;}else if(a3&&a3.fn&&a3.fn.Path){return a3.fn.Path;}});j.filter(function(a3,b3){if(a3.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&_2.indexOf(a3.Value.Path)>-1){j.splice(b3,1);}});}I1.requiresIContext=true;function J1(i,j){if(j.charAt(0)==='/'||j.indexOf("http")===0){return j;}var k=i.getModel(0).getProperty("/baseUrl");if(k){return k+"/"+j;}return j;}J1.requiresIContext=true;function K1(i,j){var k=E(i,j);return k.length;}K1.requiresIContext=true;function L1(i,j){return N1(i,j,0);}L1.requiresIContext=true;function M1(i,j){return N1(i,j,1);}M1.requiresIContext=true;function N1(i,j,k){var _2=E(i,j),a3=_2[k];if(a3&&a3.Value&&a3.Value.Path){return a3.Value.Path;}return"";}function O1(i,j){return R(i,j,0);}O1.requiresIContext=true;function P1(i,j){return R(i,j,1);}P1.requiresIContext=true;function Q1(i,j){return R(i,j,2);}Q1.requiresIContext=true;function R1(i,j){return R(i,j,3);}R1.requiresIContext=true;function S1(i,j){return R(i,j,4);}S1.requiresIContext=true;function T1(i,j,k){return Q(i,j,k);}T1.requiresIContext=true;function U1(i,j,k){return X(i,j,k);}U1.requiresIContext=true;function V1(i,j,k,_2){var a3=K1(i,j);if(a3>0){return U1(i,j,k);}else{return T1(i,j,_2);}}V1.requiresIContext=true;function W1(i,j,k){return p2(i,j,k);}W1.requiresIContext=true;function X1(i,j){return U(i,j,0);}X1.requiresIContext=true;function Y1(i,j){return U(i,j,1);}Y1.requiresIContext=true;function Z1(i,j){return U(i,j,2);}Z1.requiresIContext=true;function $1(i,j){return W(i,j,0);}$1.requiresIContext=true;function _1(j,k){for(var i=0;i<k.length;i++){var _2=k[i];if(_2.RecordType==="com.sap.vocabularies.UI.v1.DataField"){if(_2.IconUrl&&_2.IconUrl.String){return _2.IconUrl.String;}if(_2.IconUrl&&_2.IconUrl.Path){return O.simplePath(j,_2.IconUrl);}}}}_1.requiresIContext=true;function a2(i,j,k){var _2="";var a3;if(q.isArray(j)){a3=E(i,j)[k];}else{var b3=q.extend({},j);var c3=q.extend({},i);a3=n2(c3,b3);}if(!a3||!a3.Value){return _2;}var d3=i.getSetting('ovpCardProperties');var e3=d3&&d3.getProperty("/entityType");var f3=d3&&d3.getProperty("/metaModel");var g3=f3&&f3.getODataProperty(e3,a3.Value.Path);var h3=g3&&g3["Org.OData.Measures.V1.ISOCurrency"];if(h3&&h3.Path){_2+=(" "+c1([h3.Path]));}else if(h3&&h3.String){_2+=(" "+h3.String);}return _2;}a2.requiresIContext=true;function b2(i,j,k,_2){return X(i,j,k,_2);}b2.requiresIContext=true;function c2(i,j){return j1(i,j,0);}c2.requiresIContext=true;function d2(i,j){return m1(i,j,0);}d2.requiresIContext=true;function e2(i,j){return j1(i,j,1);}e2.requiresIContext=true;function f2(i,j){return j1(i,j,2);}f2.requiresIContext=true;function g2(i,j){return o1(i,j,0);}g2.requiresIContext=true;function h2(i){var j={};j.EnumMember="None";if(Number(i)===1){j.EnumMember="Negative";}else if(Number(i)===2){j.EnumMember="Critical";}else if(Number(i)===3){j.EnumMember="Positive";}return v(j,g.ColorValues);}function i2(i,j){if(j&&j.Criticality&&j.Criticality.Path){return"{parts: [{path:'"+j.Criticality.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.kpiValueCriticality'}";}else{return p1(i,j,g.ColorValues);}}i2.requiresIContext=true;function j2(i,j){return Y(i,j,0);}j2.requiresIContext=true;function k2(i,j){var k=E(i,j)[0];if(k&&(k.Criticality||k.CriticalityCalculation)){return true;}return false;}k2.requiresIContext=true;function l2(i,j){return Y(i,j,1);}l2.requiresIContext=true;function m2(i,j){return Y(i,j,2);}m2.requiresIContext=true;function n2(i,j){var k=i.getPath(0);var _2=k.slice(0,k.lastIndexOf("/"));_2=_2.slice(0,_2.lastIndexOf("/"));var a3=K(_2,j);j=i.getModel(0).getProperty(a3);return j;}function o2(i,j){if(!j){return"";}return $(i,j);}o2.requiresIContext=true;function p2(j,k,_2,a3){var b3;var c3=a3==undefined?_2:B(j,_2)[a3];var d3=j.getSetting('ovpCardProperties');var e3=d3.getProperty("/metaModel");var f3=e3.getODataEntityType(k.entityType);var g3=f3.property;if(g3){for(var i=0;i<g3.length;i++){if(c3.Value.Path===g3[i].name){b3=g3[i]["com.sap.vocabularies.Common.v1.SemanticObject"];if(b3){return O.format(j,b3);}else{return"";}}}}}function q2(i,j,k){if(!j){return"";}var _2=i.getSetting('ovpCardProperties');var a3=_2.getProperty("/entityType");var b3=_2.getProperty("/metaModel");var c3=q.extend({},j);var d3=q.extend({},i);j=n2(d3,c3);return _(i,j,a3,b3,k);}q2.requiresIContext=true;function r2(i,j){var k=q.extend({},j);var _2=q.extend({},i);var a3="None",b3=g.StateValues;j=n2(_2,k);if(j&&j.Criticality){a3=n1(i,j,b3);}else{a3=p1(i,j,b3);}return a3;}r2.requiresIContext=true;function s2(i,j){var k=q.extend({},j);var _2=q.extend({},i);j=n2(_2,k);if(j&&j.Criticality){return true;}}s2.requiresIContext=true;function t2(i,j){var k=q.extend({},j);var _2=q.extend({},i);var a3=i.getSetting('ovpCardProperties');var b3=a3.getProperty("/entityType");var c3=a3.getProperty("/metaModel");j=n2(_2,k);if(!j){return;}var d3=c3.getODataProperty(b3,j.Value.Path);if(j&&d3&&d3.type=="Edm.String"&&(j.Criticality||j.CriticalityCalculation)){return true;}}t2.requiresIContext=true;function u2(i,j){var k=q.extend({},j);var _2=q.extend({},i);j=n2(_2,k);var a3="None";if(j&&j.Criticality&&j.Criticality.Path){a3="{path:'"+j.Criticality.Path+"'}";}else{a3=p1(i,j,g.StateValues);a3=w(a3);}return a3;}u2.requiresIContext=true;function v2(j,k){var _2;for(var i=0;i<k.length;i++){_2=k[i];if(_2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||_2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||_2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return 1;}}return 0;}v2.requiresIContext=true;function w2(i,j){var k=E(i,j)[0];if(k&&k.Value&&k.Value.Path){var _2=i.getPath(0).substr(0,i.getPath(0).lastIndexOf("/")+1);var a3=i.getModel(0);var b3=a3.getProperty(_2);var c3=a3.getODataProperty(b3,k.Value.Path);if(c3&&c3["Org.OData.Measures.V1.Unit"]){return c3["Org.OData.Measures.V1.Unit"].String==="%";}}return false;}w2.requiresIContext=true;function x2(i){var j=i.getObject();var k=i.getModel();var _2=k.getProperty("/metaModel");var a3=_2.getODataEntitySet(k.getProperty("/entitySet"));var b3=_2.getODataEntityType(a3.entityType);j=b3.$path+"/"+j;return _2.createBindingContext(j);}function y2(j,k,_2,a3,b3){var c3="";var d3=new o.Model(o.Model.ReferenceByModel(j));var e3=d3.findQueryResultByName(k.name);if(!e3){c3="/"+k.name;return c3;}var f3=new o.QueryResultRequest(e3);var g3=e3.getParameterization();if(!g3){c3="/"+k.name;return c3;}if(b3){var h3=b3.getAnalyticalParameters();}if(g3){var i3;f3.setParameterizationRequest(new o.ParameterizationRequest(g3));if(_2&&_2.Parameters){q.each(_2.Parameters,function(){if(this.RecordType==="com.sap.vocabularies.UI.v1.IntervalParameter"){i3=this.PropertyNameFrom.PropertyPath.split("/");f3.getParameterizationRequest().setParameterValue(i3[i3.length-1],this.PropertyValueFrom.String,this.PropertyValueTo.String);}else{i3=this.PropertyName.PropertyPath.split("/");f3.getParameterizationRequest().setParameterValue(i3[i3.length-1],this.PropertyValue.String);}});}else if(a3){q.each(a3,function(){f3.getParameterizationRequest().setParameterValue(this.path,this.value);});}else if(h3&&h3.length>0){var j3=b3&&b3.getUiState({allFilters:false});var k3=j3?JSON.stringify(j3.getSelectionVariant()):"{}";var _2=new S(k3);for(var l3 in g3.getAllParameters()){for(var i=0;i<h3.length;i++){if(h3[i]&&(h3[i].name==l3)){var m3=h3[i].name;var n3=_2.getParameter(m3);if(!n3){var o3=_2.getSelectOption(m3);n3=o3&&o3[0]&&o3[0].Low;}f3.getParameterizationRequest().setParameterValue(l3,n3);}}}}else{c3="/"+k.name;q.sap.log.error("SelectionParameters","There are no parameters to resolve");return c3;}}try{c3=f3.getURIToQueryResultEntitySet();}catch(p3){e3=f3.getQueryResult();c3="/"+e3.getEntitySet().getQName();q.sap.log.error("getEntitySetPathWithParameters","binding path with parameters failed - "+p3||p3.message);}return c3;}function z2(j,k,ns){var _2=j.getServiceMetadata().dataServices.schema[0].association;for(var i=0;i<_2.length;i++){if(ns+"."+_2[i].name===k){return _2[i];}}}function A2(i,j){var k=i.filter(function(a3){if(a3.RecordType==="com.sap.vocabularies.UI.v1.DataField"){return true;}return false;});var _2=M(k);if(_2){return _2[j];}return;}function B2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=A2(k,0);return p2(i,j,k);}B2.requiresIContext=true;function C2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=A2(k,1);return p2(i,j,k);}C2.requiresIContext=true;function D2(i,j){var k=i.filter(function(a3){if(a3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&a3.Target.AnnotationPath.indexOf("@com.sap.vocabularies.Communication.v1.Contact")!==-1){return true;}return false;});var _2=M(k);if(_2){return _2[j];}return;}function E2(i){if(!i||!i.length||i.length===0){return false;}var j=D2(i,0);if(j){return true;}return false;}function F2(i,j,k,_2){var a3,b3,c3;if(k&&k.Value&&k.Value.Path){a3=k.Value.Path;}else if(k&&k.Description&&k.Description.Value&&k.Description.Value.Path){a3=k.Description.Value.Path;}if(k&&k.Description&&k.Description.Path){b3=k.Description.Path;}else if(k&&k.Title&&k.Title.Path){c3=k.Title.Path;}var d3="";var e3=_2&&_2.Parameters;var f3="";var g3=i.getSetting('ovpCardProperties'),h3=g3.getProperty('/parameters');e3=e3||!!h3;if(e3){var i3=i.getSetting("dataModel");var j3=y2(i3,j,_2,h3);d3+="{path: '"+j3+"'";}else{d3+="{path: '/"+j.name+"'";}d3+=", length: 1";var k3=i.getSetting('ovpCardProperties');var l3=k3.getProperty("/entityType");var m3=C.getUnitColumn(a3,l3);var n3=C1(k3,_2);if(n3.length>0){f3+=", filters: "+JSON.stringify(n3);}var o3=[];o3.push(a3);if(b3){o3.push(b3);}else if(c3){o3.push(c3);}if(k&&k.Criticality&&k.Criticality.Path){o3.push(k.Criticality.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeLowValue&&k.CriticalityCalculation.DeviationRangeLowValue.Path){o3.push(k.CriticalityCalculation.DeviationRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeLowValue&&k.CriticalityCalculation.ToleranceRangeLowValue.Path){o3.push(k.CriticalityCalculation.ToleranceRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeHighValue&&k.CriticalityCalculation.DeviationRangeHighValue.Path){o3.push(k.CriticalityCalculation.DeviationRangeHighValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeHighValue&&k.CriticalityCalculation.ToleranceRangeHighValue.Path){o3.push(k.CriticalityCalculation.ToleranceRangeHighValue.Path);}if(m3){o3.push(m3);}if(k&&k.TrendCalculation&&k.TrendCalculation.ReferenceValue&&k.TrendCalculation.ReferenceValue.Path){o3.push(k.TrendCalculation.ReferenceValue.Path);}return d3+", parameters:{select:'"+o3.join(",")+"'}"+f3+"}";}F2.requiresIContext=true;function G2(k){if(isNaN(k)){return k;}var i,j,_2=false;if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits){i=Number(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits);}if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.percentageAvailable){_2=true;}if(!i||i<0){i=0;}else if(i>2){i=2;}j=k;if(k){var a3=N.getFloatInstance({minFractionDigits:i,maxFractionDigits:i,style:"short",showScale:true,shortRefNumber:j});if(_2){return a3.format(Number(k))+" %";}else{return a3.format(Number(k));}}}function H2(i){if(!i||!i.Value||!i.Value.Path){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var _2=j.getProperty("/metaModel");var a3=_2.getODataProperty(k,i.Value.Path);if(a3["Org.OData.Measures.V1.Unit"]){var b3=a3["Org.OData.Measures.V1.Unit"];if(b3.String=="%"){this.getModel("ovpCardProperties").oData.percentageAvailable=true;}}return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.KpiValueFormatter'}";}function I2(i,j){if(!j||!j.Value||!j.Value.Path||!j.TrendCalculation){return"";}var k=G1(j.Value);var _2=G1(j.TrendCalculation.ReferenceValue);var a3=G1(j.TrendCalculation.DownDifference);var b3=G1(j.TrendCalculation.UpDifference);var c3=r1(_2);var d3=r1(a3);var e3=r1(b3);var f3="parts: ["+k;f3+=c3?","+_2:"";f3+=d3?","+a3:"";f3+=e3?","+b3:"";f3+="]";var g3=function(){var i3=1;return z(arguments[0],c3?arguments[i3++]:_2,d3?arguments[i3++]:a3,e3?arguments[i3++]:b3);};var h3=u(g3,"formatTrendDirection");return"{"+f3+", formatter: '"+h3+"'}";}I2.requiresIContext=true;function J2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}if(i.TrendCalculation.ReferenceValue.Path){return"{parts: [{path:'"+i.Value.Path+"'}, {path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}else{return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}}function K2(k,i){var j,_2,a3,b3,c3=false;if(isNaN(+k)){return"";}if(k==0){b3=i;}else{b3=k;}_2=this.getModel('ovpCardProperties');if(_2.getProperty("/iNumberOfFractionalDigits")){a3=+(_2.getProperty("/iNumberOfFractionalDigits"));}if(_2.getProperty("/bPercentageAvailableForTarget")){c3=true;}if(i){j=i;}else{if(_2.getProperty("/sManifestTargetValue")){j=_2.getProperty("/sManifestTargetValue");}}if(!a3||a3<0){a3=0;}else if(a3>2){a3=2;}if(j){var d3=N.getFloatInstance({minFractionDigits:a3,maxFractionDigits:a3,style:"short",showScale:true,shortRefNumber:b3});if(c3){return d3.format(+(j))+" %";}else{return d3.format(+(j));}}}function L2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(!i||!i.Value||!i.Value.Path){return"";}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var _2=j.getProperty("/metaModel");if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){j.setProperty("/iNumberOfFractionalDigits",i.ValueFormat.NumberOfFractionalDigits.Int);}if(i.TrendCalculation.ReferenceValue){if(i.TrendCalculation.ReferenceValue.String){j.setProperty("/sManifestTargetValue",i.TrendCalculation.ReferenceValue.String);return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}if(i.TrendCalculation.ReferenceValue.Path){var a3=_2.getODataProperty(k,i.TrendCalculation.ReferenceValue.Path);if(a3["Org.OData.Measures.V1.Unit"]){var b3=a3["Org.OData.Measures.V1.Unit"];if(b3.String=="%"){j.setProperty("/bPercentageAvailableForTarget",true);}}return"{parts: [{path:'"+i.Value.Path+"'},{path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}}}function M2(k,i){var j,_2,a3;if(isNaN(+k)){return"";}k=+(k);a3=this.getModel('ovpCardProperties');if(a3.getProperty("/iNumberOfFractionalDigits")){j=+(a3.getProperty("/iNumberOfFractionalDigits"));}if(i){_2=+(i);}else{if(a3.getProperty("/sManifestTargetValue")){_2=+(a3.getProperty("/sManifestTargetValue"));}}if(!j||j<0){j=0;}else if(j>2){j=2;}if(_2){var b3=((k-_2)/_2);var c3=N.getPercentInstance({style:'short',minFractionDigits:j,maxFractionDigits:j,showScale:true});return c3.format(b3);}}function N2(i){if(i&&i.GroupBy&&!(q.isEmptyObject(i.GroupBy))&&i.GroupBy[0].hasOwnProperty('PropertyPath')){return true;}else{return false;}}function O2(j,k){var _2;for(var i=0;j&&i<j.length;i++){if(j[i].value==k){_2=j[i];break;}}return _2?_2.name:null;}function P2(i,k){return O2(i,k);}function Q2(i,k){var j=O2(i,k);return j?j:b.getText("OVP_KEYUSER_LABEL_NO_NAVIGATION");}function R2(i){var j="";var k=i&&i.GroupBy;if(!k){return j;}var _2=this.getModel('ovpCardProperties').getProperty("/metaModel");var a3=this.getModel('ovpCardProperties').getProperty("/entityType");var b3;if(i.GroupBy.constructor===Array){b3=i.GroupBy;}else if(!i.GroupBy.Collection){return j;}else{b3=i.GroupBy.Collection;}var c3;q.each(b3,function(){c3=Y2(_2,a3,this.PropertyPath);if(!c3){return;}j+=c3;j+=", ";});if(j[j.length-1]===" "&&j[j.length-2]===","){j=j.substring(0,j.length-2);}return j==""?"":b.getText("By",[j]);}function S2(i,j,k){var _2=true;var a3=k["SelectOptions"].length-1;if(j.PropertyName.PropertyPath===k["SelectOptions"][a3].PropertyName.PropertyPath){_2=false;}j=[j];var b3=i.getSetting('ovpCardProperties');var c3=b3.getProperty("/entityType");var d3=b3.getProperty("/metaModel");var e3=C1(b3,j);if(e3.length==0){return"";}var f3;var g3;f3=e3[0].path;g3=Z2(d3,c3,f3);if(g3!==f3){return"";}var h3=d3.getODataProperty(c3,j[0].PropertyName.PropertyPath)["type"];var i3=W2(e3,h3);if(_2===true){return i3+", ";}return i3;}S2.requiresIContext=true;function T2(i,j,k){var _2=!(j.index===(k.length-1));var a3=i.getSetting('ovpCardProperties');var b3=a3.getProperty("/metaModel");var c3=a3.getProperty("/entityType");var d3=b3.getODataProperty(c3,k[j.index].path)["type"];var e3=W2([k[j.index]],d3);if(_2===true){return e3+", ";}return e3;}T2.requiresIContext=true;function U2(i){return i.id;}function V2(i){return i.id;}function W2(j,k){var _2=[];for(var i=0;i<j.length;i++){_2.push(X2(j[i],k));}return _2.join(', ');}function X2(i,j){var k=false;var _2,a3=D.getInstance({'style':'medium'});if(j==='Edm.DateTime'){_2=a3.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){_2=a3.format(new Date(i.value1),true);}else{_2=i.value1;}if(i.operator[0]==="N"){k=true;}if(i.value2){if(j==='Edm.DateTime'){_2+=" - "+a3.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){_2+=" - "+a3.format(new Date(i.value1),true);}else{_2+=" - "+i.value1;}}if(k){_2=b.getText("kpiHeader_Filter_NotOperator",[_2]);}return _2;}function Y2(i,j,k){return $2(i,j,k,"com.sap.vocabularies.Common.v1.Label");}function Z2(i,j,k){return $2(i,j,k,"sap:text");}function $2(i,j,k,_2){var a3=i.getODataProperty(j,k);if(!a3){q.sap.log.error("No Property Found for with Name '"+k+" For Entity-Type '"+j.name+"'");return;}var b3=a3[_2];if(b3){if(_2==="com.sap.vocabularies.Common.v1.Label"){return b3.String;}return b3;}return a3.name;}return{NumberFormatFunctions:c,DateFormatFunctions:d,CurrencyFormatFunctions:e,formatFunctions:f,criticalityConstants:g,TextArrangementType:T,formatterGeo:h,criticalityType:m,getCriticalityStateFromValue:n,getLabelForDataItem:r,colorPaletteForComparisonMicroChart:l1,formatField:$,formatItems:t1,getCardSelections:z1,getCardSorters:A1,getFilters:C1,getPrimitiveValue:F1,getAnnotationLabel:P2,getApplicationName:Q2,removeDuplicateDataField:I1,formatUrl:J1,getDataPointsCount:K1,getFirstDataPointValue:L1,getFirstDataFieldName:O1,getSecondDataFieldName:P1,getRequestFields:y1,getThirdDataFieldName:Q1,formatDataFieldValueOnIndex:T1,formatDataPointValueOnIndex:U1,formatDataPointOrField:V1,formatsemanticObjectOfDataFieldGeneric:W1,getLabelForFirstDataPoint:$1,formatImageUrl:_1,formatUnit:a2,formatObjectNumber:b2,formatFirstDataPointState:c2,formatFirstDataPointColor:d2,formatSecondDataPointState:e2,formatThirdDataPointState:f2,formatFirstDataPointStateForSmartField:g2,formatKPIHeaderState:i2,isFirstDataPointCriticality:j2,isFirstDataPointCriticalityForTableStatus:k2,getSortedDataFields:B,getSortedDataPoints:E,formatDataFieldValueGeneric:o2,formatDataPointValue:q2,formatDataPointStateGeneric:r2,checkCriticalityGeneric:s2,checkCriticalityGenericForTableStatus:t2,formatDataPointStateForSmartFieldGeneric:u2,hasActions:v2,isFirstDataPointPercentageUnit:w2,resolveEntityTypePath:x2,resolveParameterizedEntitySet:y2,getAssociationObject:z2,semanticObjectOfFirstDataField:B2,semanticObjectOfSecondDataField:C2,isFirstContactAnnotation:E2,getAggregateNumber:F2,KpiValueFormatter:G2,kpiValueCriticality:h2,formThePathForAggregateNumber:H2,formThePathForTrendIcon:I2,formPathForPercentageChange:J2,TargetValueFormatter:K2,formPathForTargetValue:L2,returnPercentageChange:M2,isPresentationVarientPresent:N2,listGroupBy:R2,formTheFilterByString:S2,formTheFilterByStringNotFromSelVar:T2,formTheIdForFilter:U2,formTheIdForFilterNotFromSelVar:V2,_criticality2state:v,_calculateCriticalityState:y,_calculateTrendDirection:z,_getPropertiesFromBindingString:w1,sortCollectionByImportance:M};},true);
