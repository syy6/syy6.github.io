/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
sap.ui.define(['jquery.sap.global','sap/ovp/cards/CommonUtils'],function(q,C){"use strict";function a(o,g){g.every(function(h){if(h.id===o.cardId){h.selectedKey=o.selectedKey;return false;}return true;});return g;}function b(o,g){g.every(function(h){if(h.id===o.cardId){h.visibility=o.visibility;return false;}return true;});return g;}function c(o,g,v){var M=C.getApp(),s=M._getCardId(o.id);g.every(function(h){if(h.id===s){h.visibility=v;return false;}return true;});return g;}function d(o,g){var i=[];var v,t;v=g.filter(function(h){return h.visibility;});g.forEach(function(h,I){if(!h.visibility){i.push({card:h,index:I});}});if(!v[o.oldPosition]||!v[o.position]){return g;}t=v[o.oldPosition];v[o.oldPosition]=v[o.position];v[o.position]=t;i.forEach(function(I){v.splice(I.index,0,I.card);});g=v;return g;}function e(o,g){g.every(function(h){if(h.id===o.cardId){Object.keys(o.dashboardLayout).forEach(function(k){if(!h.dashboardLayout[k]){h.dashboardLayout[k]={};}if(o.dashboardLayout[k].rowSpan){h.dashboardLayout[k].rowSpan=o.dashboardLayout[k].rowSpan;}if(o.dashboardLayout[k].colSpan){h.dashboardLayout[k].colSpan=o.dashboardLayout[k].colSpan;}if(o.dashboardLayout[k].maxColSpan){h.dashboardLayout[k].maxColSpan=o.dashboardLayout[k].maxColSpan;}if(o.dashboardLayout[k].noOfItems){h.dashboardLayout[k].noOfItems=o.dashboardLayout[k].noOfItems;}if(o.dashboardLayout[k].hasOwnProperty('autoSpan')){h.dashboardLayout[k].autoSpan=o.dashboardLayout[k].autoSpan;}if(o.dashboardLayout[k].row){h.dashboardLayout[k].row=o.dashboardLayout[k].row;}if(o.dashboardLayout[k].column){h.dashboardLayout[k].col=o.dashboardLayout[k].column;}if(o.dashboardLayout[k].hasOwnProperty('showOnlyHeader')){h.dashboardLayout[k].showOnlyHeader=o.dashboardLayout[k].showOnlyHeader;}});return false;}return true;});return g;}function m(g,D){if(!Array.isArray(D)||!g){return g;}var M=[];g.forEach(function(o){var h={};Object.keys(o).forEach(function(k){h[k]=o[k];});M.push(h);});D.forEach(function(o){switch(o.getChangeType()){case"viewSwitch":M=a(o.getContent(),M);break;case"visibility":M=b(o.getContent(),M);break;case"hideCardContainer":M=c(o.getContent(),M,false);break;case"unhideCardContainer":M=c(o.getContent(),M,true);break;case"position":M=d(o.getContent(),M);break;case"dragOrResize":M=e(o.getContent(),M);break;default:break;}});return M;}function f(M,D){var g=M.filter(function(o){var h=false;D.forEach(function(i){if(o.id===i.id){h=true;return;}});return!h;});return D.concat(g);}var p={mergeChanges:m,addMissingCardsFromManifest:f};return p;},true);
