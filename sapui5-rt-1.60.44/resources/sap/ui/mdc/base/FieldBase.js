/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2018 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/thirdparty/jquery','sap/ui/Device','./FieldBaseRenderer','sap/ui/mdc/library','sap/ui/mdc/base/FilterOperatorConfig','sap/ui/core/Control','sap/base/util/ObjectPath','sap/base/util/deepEqual','sap/base/util/merge','sap/ui/dom/containsOrEquals','sap/ui/model/base/ManagedObjectModel','sap/ui/base/ManagedObjectObserver'],function(q,D,F,l,a,C,O,d,m,c,M,b){"use strict";var E=l.EditMode;var e=l.FieldDisplay;var f=C.extend("sap.ui.mdc.base.FieldBase",{metadata:{interfaces:["sap.ui.core.IFormContent"],library:"sap.ui.mdc",properties:{dataType:{type:"string",group:"Data",defaultValue:'sap.ui.model.type.String'},dataTypeConstraints:{type:"object",group:"Data",defaultValue:null},dataTypeFormatOptions:{type:"object",group:"Data",defaultValue:null},editMode:{type:"sap.ui.mdc.EditMode",group:"Data",defaultValue:E.Editable},required:{type:"boolean",group:"Data",defaultValue:false},display:{type:"sap.ui.mdc.FieldDisplay",defaultValue:e.Value},textAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:sap.ui.core.TextAlign.Initial},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:sap.ui.core.TextDirection.Inherit},placeholder:{type:"string",group:"Misc",defaultValue:null},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:sap.ui.core.ValueState.None},valueStateText:{type:"string",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},multipleLines:{type:"boolean",group:"Appearance",defaultValue:false},fieldPath:{type:"string",group:"Data",defaultValue:null},maxConditions:{type:"int",group:"Behavior",defaultValue:-1},conditions:{type:"object[]",group:"Data",defaultValue:[]},_value:{type:"any",group:"Data",visibility:"hidden"},_description:{type:"string",group:"Data",defaultValue:"",visibility:"hidden"},_fieldHelpEnabled:{type:"boolean",group:"Appearance",defaultValue:false,visibility:"hidden"},_onlyEEQ:{type:"boolean",group:"Appearance",defaultValue:false,visibility:"hidden"}},aggregations:{content:{type:"sap.ui.core.Control",multiple:false},_content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},fieldInfo:{type:"sap.ui.mdc.base.FieldInfoBase",multiple:false}},associations:{fieldHelp:{type:"sap.ui.mdc.base.FieldHelpBase",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{liveChange:{parameters:{value:{type:"string"},escPressed:{type:"boolean"},previousValue:{type:"string"}}},press:{}},publicMethods:[],defaultAggregation:"content",defaultProperty:"value"},_oManagedObjectModel:null});var g={"default":{edit:"sap/m/Input",editMulti:"sap/m/MultiInput",editMultiLine:"sap/m/TextArea",display:"sap/m/Text",createEdit:Q,createEditMulti:S,createEditMultiLine:T,createDisplay:U},"search":{edit:"sap/m/SearchField",display:"sap/m/SearchField",createEdit:R,createDisplay:R},date:{edit:"sap/m/DatePicker",editMulti:"sap/m/MultiInput",display:"sap/m/Text",createEdit:V,createEditMulti:S,createDisplay:U},time:{edit:"sap/m/TimePicker",editMulti:"sap/m/MultiInput",display:"sap/m/Text",createEdit:V,createEditMulti:S,createDisplay:U},dateTime:{edit:"sap/m/DateTimePicker",editMulti:"sap/m/MultiInput",display:"sap/m/Text",createEdit:V,createEditMulti:S,createDisplay:U},link:{edit:undefined,display:"sap/m/Link",createEdit:undefined,createDisplay:W},bool:{edit:"sap/m/Input",display:"sap/m/Text",createEdit:X,createDisplay:U}};var h={};var j={bool:{name:"sap/ui/mdc/base/BoolFieldHelp",id:"BoolDefaultHelp",control:undefined}};f.prototype.init=function(){this._oManagedObjectModel=new M(this);this._oObserver=new b(this._observeChanges.bind(this));this._oObserver.observe(this,{properties:["display","editMode","dataType","multipleLines","maxConditions","conditions"],aggregations:["fieldInfo","content"],associations:["fieldHelp"]});this._oDatePickerRequested={};this.attachModelContextChange(y.bind(this));};f.prototype.exit=function(){var i=this.getFieldInfo();if(i){i.detachEvent("dataUpdate",r1,this);}this._oManagedObjectModel.destroy();delete this._oManagedObjectModel;this._oObserver.disconnect();this._oObserver=undefined;if(this._oFilterOperatorConfig){this._oFilterOperatorConfig.destroy();delete this._oFilterOperatorConfig;}};f.prototype.applySettings=function(i,s1){C.prototype.applySettings.apply(this,arguments);};f.prototype.onBeforeRendering=function(){L.call(this);};f.prototype.onAfterRendering=function(){if(i1.call(this)&&this.getEditMode()!=E.Display){var i=this.getAggregation("_content");if(i){var s1=i.getFocusDomRef();q(s1).attr("autocomplete","off");}}};f.prototype.onfocusin=function(i){o1.call(this);};f.prototype.onsapup=function(i){var s1=i1.call(this);if(s1){i.preventDefault();i.stopPropagation();s1.navigate(-1);}};f.prototype.onsapdown=function(i){var s1=i1.call(this);if(s1){i.preventDefault();i.stopPropagation();s1.navigate(1);}};f.prototype.clone=function(i,s1){var t1=this.getContent();if(t1){K.call(this,t1);}var u1=this.getFieldInfo();if(u1){u1.detachEvent("dataUpdate",r1,this);}var v1=C.prototype.clone.apply(this,arguments);if(t1){J.call(this,t1);}if(u1){u1.attachEvent("dataUpdate",r1,this);}return v1;};f.prototype._fireChange=function(i,s1){};f.mapEdmTypes={"Edm.Boolean":"sap.ui.model.odata.type.Boolean","Edm.Byte":"sap.ui.model.odata.type.Byte","Edm.Date":"sap.ui.model.odata.type.Date","Edm.DateTime":"sap.ui.model.odata.type.DateTime","Edm.DateTimeOffset":"sap.ui.model.odata.type.DateTimeOffset","Edm.Decimal":"sap.ui.model.odata.type.Decimal","Edm.Double":"sap.ui.model.odata.type.Double","Edm.Float":"sap.ui.model.odata.type.Single","Edm.Guid":"sap.ui.model.odata.type.Guid","Edm.Int16":"sap.ui.model.odata.type.Int16","Edm.Int32":"sap.ui.model.odata.type.Int32","Edm.Int64":"sap.ui.model.odata.type.Int64","Edm.SByte":"sap.ui.model.odata.type.SByte","Edm.Single":"sap.ui.model.odata.type.Single","Edm.String":"sap.ui.model.odata.type.String","Edm.Time":"sap.ui.model.odata.type.Time","Edm.TimeOfDay":"sap.ui.model.odata.type.TimeOfDay"};function _(i){var s1=O.get(i||"");if(!s1){var t1=f.mapEdmTypes[i];if(!t1){return null;}return _.call(this,t1);}return new s1(this.getDataTypeFormatOptions(),this.getDataTypeConstraints());}function k(){if(!this._oDataType){this._oDataType=this.getDataType();if(typeof this._oDataType==="string"){this._oDataType=_.call(this,this._oDataType);}}return this._oDataType;}f.prototype._getDataType=function(){return k.call(this);};function n(){if(this._oDataType&&typeof this._oDataType==="object"){return this._oDataType.getMetadata().getName();}else{return this.getDataType();}}function o(){if(this._oDataType&&typeof this._oDataType==="object"&&this._oDataType.oConstraints){return this._oDataType.oConstraints;}else{return this.getDataTypeConstraints();}}function p(s1,t1){var u1=i1.call(this);var v1=this.getMaxConditions();var w1=x.call(this);var x1;var y1;var i=0;var z1=false;var A1;if(s1.length>0){A1=k.call(this);}for(i=0;i<s1.length;i++){var B1=m({},s1[i]);if(A1&&(A1.getMetadata().getName()==="sap.ui.model.type.Unit"||A1.getMetadata().getName()==="sap.ui.model.type.Currency")){x1=m([],B1.values);}else if(!w1||B1.operator==="EQ"||B1.operator==="EEQ"){B1.values=c1.call(this,B1);x1=B1.values[0];y1=B1.values[1];}}if(v1===1){if(!y1){y1=x1;}if(x1!==u.call(this)||y1!==w.call(this)){z1=true;t.call(this,x1,true);v.call(this,y1,true);}}if(u1&&this._bConnected){u1.setConditions(s1);}if(z1||t1){this._oManagedObjectModel.checkUpdate();}}f.prototype._getContent=function(){return this.getContent()||this.getAggregation("_content");};function r(i){if(i&&i===E.Editable){return true;}else{return false;}}function s(i){if(i&&i!=E.Disabled){return true;}else{return false;}}function t(i,s1){return this.setProperty("_value",i,s1);}function u(){return this.getProperty("_value");}function v(i,s1){return this.setProperty("_description",i,s1);}function w(){return this.getProperty("_description");}function x(){return this.getProperty("_onlyEEQ");}f.prototype._getOnlyEEQ=function(){return x.call(this);};function y(i){if(!this._bFFAdded){var s1=z.call(this);if(s1){s1.addFilterField(this);this._bFFAdded=true;}}}function z(){var i=this.getBinding("conditions");if(i){var s1=i.getModel();if(s1.isA("sap.ui.mdc.base.ConditionModel")){return s1;}}return undefined;}f.prototype._getFilterOperatorConfig=function(){var i=z.call(this);if(i){return i.getFilterOperatorConfig();}else if(this._oFilterOperatorConfig){return this._oFilterOperatorConfig;}else{this._oFilterOperatorConfig=a.getFor();return this._oFilterOperatorConfig;}};f.prototype._createItemCondition=function(i,s1){var t1=z.call(this);var u1;if(t1){u1=t1.createItemCondition(this.getFieldPath(),i,s1);}else{var v1=[i,s1];if(s1===null||s1===undefined){v1.pop();}u1=A.call(this,"EEQ",v1);}return u1;};function A(i,s1){var t1=z.call(this);var u1;if(t1){u1=t1.createCondition(this.getFieldPath(),i,s1);}else{u1={fieldPath:this.getFieldPath(),operator:i,values:s1};}return u1;}function B(s1){var t1=-1;var u1=this.getConditions();var v1=JSON.stringify(s1,['fieldPath','operator','values']);u1.some(function(s1,i){if(JSON.stringify(s1,['fieldPath','operator','values'])===v1){t1=i;return true;}return false;});return t1;}function G(i){var s1=z.call(this);if(s1){s1.setUIMessage(this.getFieldPath(),i);}}function H(){var i=z.call(this);if(i){i.removeUIMessage(this.getFieldPath());}}f.prototype._observeChanges=function(i){if(i.name==="editMode"){if(this.getAggregation("_content")){L.call(this);}}if(i.name==="multipleLines"){if(this.getAggregation("_content")){L.call(this);}}if(i.name==="dataType"){if(this._oDataType){this._oDataType.destroy();this._oDataType=undefined;}this.destroyAggregation("_content");}if(i.name==="maxConditions"){if(this.getAggregation("_content")){L.call(this);}}if(i.name==="conditions"){p.call(this,i.current,i.old);}if(i.name==="display"){this.destroyAggregation("_content");}if(i.name==="fieldHelp"&&i.ids){h1.call(this,i.ids,i.mutation);}if(i.name==="fieldInfo"&&i.child){q1.call(this,i.child,i.mutation);}if(i.name==="content"&&i.child){I.call(this,i.child,i.mutation);}};f.prototype.getFocusDomRef=function(){var i=this._getContent();if(i){return i.getFocusDomRef();}else{return this.getDomRef();}};f.prototype.getIdForLabel=function(){var i;var s1=this._getContent();if(s1){i=s1.getIdForLabel();}else{i=this.getId();}return i;};f.prototype.enhanceAccessibilityState=function(i,s1){var t1=this.getParent();if(t1&&t1.enhanceAccessibilityState){t1.enhanceAccessibilityState(this,s1);}return s1;};function I(i,s1){if(s1==="remove"){i.unbindElement("$field");K.call(this,i);}else if(s1==="insert"){P.call(this,i);J.call(this,i);if(this.getAggregation("_content")){this.destroyAggregation("_content");}}}function J(i){if(i.getMetadata().getEvents().change){i.attachEvent("change",d1,this);}if(i.getMetadata().getEvents().liveChange){i.attachEvent("liveChange",e1,this);}if(i.getMetadata().getEvents().press){i.attachEvent("press",f1,this);}}function K(i){if(i.getMetadata().getEvents().change){i.detachEvent("change",d1,this);}if(i.getMetadata().getEvents().liveChange){i.detachEvent("liveChange",e1,this);}if(i.getMetadata().getEvents().press){i.detachEvent("press",f1,this);}}function L(){if(this.getContent()||this._bIsBeingDestroyed){return;}var i=this.getEditMode();var s1=n.call(this);var t1=o.call(this);var u1=this.getMaxConditions();var v1;var w1;var x1;var y1=this.getAggregation("_content");var z1;if(y1){z1=y1.getMetadata().getName().replace(/\./g,"/");}switch(s1){case"Edm.Date":case"sap.ui.model.type.Date":case"sap.ui.model.odata.type.Date":v1=g.date;break;case"Edm.DateTime":case"sap.ui.model.odata.type.DateTime":if(t1&&(t1.displayFormat==="Date"||t1.isDateOnly)){v1=g.date;}else{v1=g.dateTime;}break;case"Edm.DateTimeOffset":case"sap.ui.model.type.DateTime":case"sap.ui.model.odata.type.DateTimeOffset":v1=g.dateTime;break;case"Edm.TimeOfDay":case"sap.ui.model.type.Time":case"sap.ui.model.odata.type.TimeOfDay":v1=g.time;break;case"Edm.Boolean":case"sap.ui.model.type.Boolean":case"sap.ui.model.odata.type.Boolean":v1=g.bool;break;default:if(this.getFieldInfo()&&this._bTriggerable){v1=g.link;}else{var A1=new RegExp("^\\*(.*)\\*|\\$search$");if(A1.test(this.getProperty("fieldPath"))&&this.getMaxConditions()===1){v1=g.search;}else{v1=g.default;}}break;}if(i===E.Display){w1=v1.display;x1=v1.createDisplay;}else if(u1!==1){w1=v1.editMulti;x1=v1.createEditMulti;}else if(this.getMultipleLines()){w1=v1.editMultiLine;x1=v1.createEditMultiLine;}else{w1=v1.edit;x1=v1.createEdit;}if(!w1){throw new Error("No control defined for type "+s1+" in "+this);}if(w1!==z1){if(y1){this.destroyAggregation("_content");}if(!h[w1]){h[w1]={};}var B1=h[w1].control;if(!B1){if(h[w1].promise){h[w1].promise.then(L.bind(this));return;}else{B1=sap.ui.require(w1);if(B1){h[w1].control=B1;}else{h[w1].promise=new Promise(function(E1){h[w1].resolve=E1;sap.ui.require([w1],N.bind(this));}.bind(this)).then(L.bind(this));return;}}}var C1=this.getId()+"-inner";var D1=x1.call(this,B1,C1);P.call(this,D1);this.setAggregation("_content",D1);}}function N(i){var s1=i.getMetadata().getName();s1=s1.replace(/\./g,"/");h[s1].control=i;h[s1].resolve();delete h[s1].resolve;}function P(i){i.setModel(this._oManagedObjectModel,"$field");i.bindElement({path:"/",model:"$field"});}function Q(i,s1){var t1=this.getDisplay();var u1;if(t1===e.Description){u1={path:"$field>_description"};}else if(!x.call(this)){u1={path:'$field>conditions/0',formatter:$.bind(this)};}else{var v1=k.call(this);u1={path:"$field>_value",type:v1};}var w1=new i(s1,{value:u1,placeholder:"{$field>placeholder}",textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}",required:"{$field>required}",editable:{path:"$field>editMode",formatter:r},enabled:{path:"$field>editMode",formatter:s},valueState:"{$field>valueState}",valueStateText:"{$field>valueStateText}",showValueHelp:"{$field>_fieldHelpEnabled}",width:"100%",tooltip:"{$field>tooltip}",change:d1.bind(this),liveChange:e1.bind(this),valueHelpRequest:j1.bind(this)});p1.call(this,w1);return w1;}function R(i,s1){var t1=new i(s1,{value:{path:'$field>conditions/0',formatter:b1.bind(this)},placeholder:"{$field>placeholder}",width:"100%",tooltip:"{$field>tooltip}",search:d1.bind(this)});return t1;}function S(i,s1){var t1=sap.ui.require("sap/m/Token");if(!t1){throw new Error("sap.m.Token not loaded "+this);}var u1=new t1(s1+"-token",{text:{path:'$field>',formatter:$.bind(this)}});var v1=new i(s1,{placeholder:"{$field>placeholder}",textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}",required:"{$field>required}",editable:{path:"$field>editMode",formatter:r},enabled:{path:"$field>editMode",formatter:s},valueState:"{$field>valueState}",valueStateText:"{$field>valueStateText}",showValueHelp:"{$field>_fieldHelpEnabled}",width:"100%",tooltip:"{$field>tooltip}",tokens:{path:"$field>conditions",template:u1},dependents:[u1],change:d1.bind(this),liveChange:e1.bind(this),tokenUpdate:g1.bind(this),valueHelpRequest:j1.bind(this)});p1.call(this,v1);return v1;}function T(i,s1){var t1=new i(s1,{value:"{$field>_value}",placeholder:"{$field>placeholder}",textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}",required:"{$field>required}",editable:{path:"$field>editMode",formatter:r},enabled:{path:"$field>editMode",formatter:s},valueState:"{$field>valueState}",valueStateText:"{$field>valueStateText}",width:"100%",tooltip:"{$field>tooltip}",change:d1.bind(this),liveChange:e1.bind(this)});return t1;}function U(i,s1){var t1=this.getMaxConditions();var u1;if(t1===1){u1={path:'$field>conditions/0',formatter:$.bind(this)};}else{u1={path:'$field>conditions',formatter:a1.bind(this)};}var v1=new i(s1,{text:u1,textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}",wrapping:"{$field>multipleLines}",width:"100%",tooltip:"{$field>tooltip}"});return v1;}function V(i,s1){var t1=k.call(this);var u1=new i(s1,{value:{path:"$field>_value",type:t1},placeholder:"{$field>placeholder}",textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}",required:"{$field>required}",editable:{path:"$field>editMode",formatter:r},enabled:{path:"$field>editMode",formatter:s},valueState:"{$field>valueState}",valueStateText:"{$field>valueStateText}",width:"100%",tooltip:"{$field>tooltip}",change:d1.bind(this)});return u1;}function W(i,s1){var t1=new i(s1,{text:{path:'$field>conditions/0',formatter:$.bind(this)},textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}",tooltip:"{$field>tooltip}",press:f1.bind(this)});return t1;}function X(i,s1){if(!this.getFieldHelp()){Y.call(this,"bool");}return Q.call(this,i,s1);}function Y(i){this.setProperty("_fieldHelpEnabled",true,true);this._sDefaultFieldHelp=j[i].id;var s1=j[i].control;if(!s1){if(j[i].promise){j[i].promise.then(Z.bind(this));}var t1=sap.ui.require(j[i].name);if(!t1&&!j[i].promise){j[i].promise=new Promise(function(u1){j[i].resolve=u1;sap.ui.require([j[i].name],function(v1){Y.call(this,i);}.bind(this));}.bind(this)).then(Z.bind(this));}if(t1){s1=new t1(j[i].id);j[i].control=s1;this.addDependent(s1);s1.connect(this);if(j[i].resolve){j[i].resolve();delete j[i].resolve;}if(!j[i].promise){Z.call(this);}}}}function Z(){h1.call(this,"BoolDefaultHelp","insert");p1.call(this,this.getAggregation("_content"));}function $(i){var s1="";if(i&&i.operator&&i.values){var t1=this._getFilterOperatorConfig().getOperator(i.operator);var u1=c1.call(this,i);s1=t1.format(u1,i,k.call(this),this.getDisplay());}return s1;}function a1(s1){var t1="";if(s1){for(var i=0;i<s1.length;i++){var u1=s1[i];if(t1){t1=t1+"; ";}t1=t1+$.call(this,u1);}}return t1;}function b1(i){var s1="";if(i&&i.values){var t1=c1.call(this,i);s1=t1[0];}return s1;}function c1(i){var s1=i.values;if(i.operator==="EQ"||i.operator==="EEQ"){var t1=s1[0];var u1=s1[1];if(!u1&&this.getDisplay()!==e.Value){var v1=i1.call(this);if(v1){u1=v1.getTextForKey(t1);s1=[t1,u1];}}}return s1;}function d1(i){var s1=this.getMaxConditions();var t1=this.getFieldPath();var u1=this.getConditions();var v1=x.call(this);var w1;var x1;var y1=true;var z1;if("valid"in i.getParameters()){y1=i.getParameter("valid");}var A1=i.oSource.getBindingInfo("value");if(A1&&A1.binding&&A1.binding.sPath==="_value"&&y1){w1=u.call(this);}else if("value"in i.getParameters()){w1=i.getParameter("value");}else if("query"in i.getParameters()){w1=i.getParameter("query");}else{w1=u.call(this);}var B1=i1.call(this);if(B1){B1.close();B1.setFilterValue("");if(w1&&this.getDisplay()!==e.Value){x1=B1.getKeyForText(w1);if(x1===undefined||x1===null){var C1=B1.getTextForKey(w1);if(C1){x1=w1;w1=C1;}}}}var D1=k.call(this);if(w1){if(D1&&(D1.getMetadata().getName()==="sap.ui.model.type.Unit"||D1.getMetadata().getName()==="sap.ui.model.type.Currency")){z1=this._createItemCondition(w1[0],w1[1]);}else if(x1!==undefined&&x1!==null){z1=this._createItemCondition(x1,w1);}else if(v1){z1=this._createItemCondition(w1);}else{var E1=D1.getMetadata().getName();var F1=this._getFilterOperatorConfig();var G1=F1.getMatchingOperators(E1,w1);var H1;if(G1.length===0){var I1=F1.getDefaultOperator(E1);H1=F1.getOperator(I1);w1=H1?H1.format([w1],undefined,D1):w1;}else{H1=G1[0];}try{if(H1&&H1.test(w1,D1)){H.call(this);z1=H1.getCondition(w1,D1);if(z1){z1.fieldPath=t1;}}}catch(J1){G.call(this,J1.message);}}}if(s1!==1){i.getSource().setValue("");}if(z1){if(B.call(this,z1)>=0){return;}if(s1>0&&s1<=u1.length){u1.splice(0,u1.length-s1+1);}u1.push(z1);}else if(s1===1){u1=[];}if(!d(u1,this.getConditions())){this.setProperty("conditions",u1,true);if(B1&&this._bConnected){B1.setConditions(u1);}this._fireChange(u1,y1);}}function e1(i){var s1;var t1;var u1=false;if("value"in i.getParameters()){s1=i.getParameter("value");}if("escPressed"in i.getParameters()){u1=i.getParameter("escPressed");}if("previousValue"in i.getParameters()){t1=i.getParameter("previousValue");}else{t1=u.call(this);}var v1=i1.call(this);if(v1&&v1.openByTyping()){var w1;if(s1[0]==="="&&s1[1]==="="){w1=s1.slice(2);}else if(s1[0]==="="||s1[0]===">"||s1[0]==="<"){w1=s1.slice(1);}else{w1=s1;}var x1=k.call(this);if(x1&&(x1.getMetadata().getName()==="sap.ui.model.type.Unit"||x1.getMetadata().getName()==="sap.ui.model.type.Currency")){var rx=new RegExp(/^([,.\d]+)\s(\w+)$/i);var z1=w1.match(rx);if(z1){w1=z1[2];}else{rx=new RegExp(/^(\w+)\s([,.\d]+)$/i);z1=w1.match(rx);if(z1){w1=z1[1];}else if(/\d/.test(w1)){w1=undefined;}}}v1.setFilterValue(w1);v1.setConditions([]);v1.open(true);}this.fireLiveChange({value:s1,escPressed:u1,previousValue:t1});}function f1(i){var s1=this.getFieldInfo();if(s1){s1.getTriggerHref().then(function(t1){if(t1){window.location.href=t1;}else{s1.open(this._getContent());}}.bind(this));}this.firePress();}function g1(s1){if(s1.getParameter("type")==="removed"){var t1=s1.getParameter("removedTokens");var u1=this.getConditions();var i;for(i=0;i<t1.length;i++){var v1=t1[i];var w1=v1.getBindingContext("$field").sPath;var x1=parseInt(w1.slice(w1.lastIndexOf("/")+1),10);u1[x1].delete=true;}for(i=u1.length-1;i>=0;i--){if(u1[i].delete){u1.splice(i,1);}}this.setProperty("conditions",u1,true);this._fireChange(u1,true);}}function h1(i,s1){var t1=sap.ui.getCore().byId(i);if(s1==="remove"){t1.detachEvent("select",k1,this);t1.detachEvent("navigate",l1,this);t1.detachEvent("dataUpdate",m1,this);t1.detachEvent("disconnect",n1,this);this.setProperty("_fieldHelpEnabled",false,true);}else if(s1==="insert"){if(t1){t1.attachEvent("dataUpdate",m1,this);this.setProperty("_fieldHelpEnabled",true,true);}}p.call(this,this.getConditions());}function i1(){var i=this.getFieldHelp();var s1;if(!i&&this._sDefaultFieldHelp){i=this._sDefaultFieldHelp;}if(i){s1=sap.ui.getCore().byId(i);}return s1;}function j1(i){var s1=i1.call(this);if(s1){s1.setFilterValue("");s1.toggleOpen(false);}}function k1(s1){var t1=s1.getParameter("value");var u1=s1.getParameter("key");var v1=this.getConditions();var w1=s1.getParameter("conditions");var x1=s1.getParameter("add");var y1=this.getMaxConditions();var z1=x.call(this);var A1;var B1=k.call(this);var C1;var D1;var rx=new RegExp(/^([,.\d]+)\s(\w+)$/i);var F1=new RegExp(/^(\w+)\s([,.\d]+)$/i);var G1;var H1="";if(!x1){v1=[];}if(!w1){if(B1&&(B1.getMetadata().getName()==="sap.ui.model.type.Unit"||B1.getMetadata().getName()==="sap.ui.model.type.Currency")&&y1===1){C1=this._getContent();D1=C1.getDOMValue&&C1.getDOMValue();G1=D1.match(rx);if(G1){H1=G1[1]+" "+w1[0].values[1];}else{G1=D1.match(F1);if(G1){H1=w1[0].values[1]+" "+G1[2];}else if(D1&&/\d/.test(D1)){H1=D1.trim()+" "+w1[0].values[1];}else{H1="0 "+w1[0].values[1];}}G1=B1.parseValue(H1,"string");A1=this._createItemCondition(G1[0],G1[1]);v1.push(A1);}else if(this.getDisplay()!==e.Value){A1=this._createItemCondition(u1,t1);}else{A1=this._createItemCondition(t1);}if(B.call(this,A1)===-1){v1.push(A1);}}else{if(B1&&(B1.getMetadata().getName()==="sap.ui.model.type.Unit"||B1.getMetadata().getName()==="sap.ui.model.type.Currency")&&y1===1){if(w1.length>0){C1=this._getContent();D1=C1.getDOMValue&&C1.getDOMValue();G1=D1.match(rx);if(G1){H1=G1[1]+" "+w1[0].values[1];}else{G1=D1.match(F1);if(G1){H1=w1[0].values[1]+" "+G1[2];}else if(D1&&/\d/.test(D1)){H1=D1.trim()+" "+w1[0].values[1];}else{H1="0 "+w1[0].values[1];}}G1=B1.parseValue(H1,"string");A1=this._createItemCondition(G1[0],G1[1]);v1.push(A1);}}else{for(var i=0;i<w1.length;i++){A1=w1[i];if(z1&&A1.operator!=="EQ"&&A1.operator!=="EEQ"){continue;}if(!x1||B.call(this,A1)===-1){v1.push(A1);}}}}if(y1>0&&y1<v1.length){v1.splice(0,v1.length-y1);}var C1=this._getContent();if(C1&&C1.setDOMValue&&y1!==1){C1.setDOMValue("");}this.setProperty("conditions",v1,true);this._fireChange(v1,true);}function l1(i){var s1=i.getParameter("value");var t1=i.getParameter("key");var u1;var v1=k.call(this);if(v1&&(v1.getMetadata().getName()==="sap.ui.model.type.Unit"||v1.getMetadata().getName()==="sap.ui.model.type.Currency")){var w1=this._getContent();var x1=w1.getDOMValue&&w1.getDOMValue();var rx=new RegExp(/^([,.\d]+)\s(\w+)$/i);var z1=x1.match(rx);if(z1){u1=z1[1]+" "+s1;}else{rx=new RegExp(/^(\w+)\s([,.\d]+)$/i);z1=x1.match(rx);if(z1){u1=s1+" "+z1[2];}else if(x1&&/\d/.test(x1)){u1=x1.trim()+" "+s1;}else{u1=s1;}}s1=u1;}else if(this.getDisplay()===e.Description){u1=t1;}else{u1=s1;}var w1=this._getContent();if(w1&&w1.setDOMValue){w1.setDOMValue(s1);w1._doSelect();}this.fireLiveChange({value:u1});}function m1(i){p.call(this,this.getConditions());if(this.getMaxConditions()!==1||this.getDisplay()!==e.Value){this._oManagedObjectModel.checkUpdate(true);}}function n1(i){var s1=i1.call(this);s1.detachEvent("select",k1,this);s1.detachEvent("navigate",l1,this);s1.detachEvent("disconnect",n1,this);this._bConnected=false;}function o1(){var i=i1.call(this);if(i&&!this._bConnected){i.connect(this);this._bConnected=true;i.attachEvent("select",k1,this);i.attachEvent("navigate",l1,this);i.attachEvent("disconnect",n1,this);var s1=this.getConditions();i.setConditions(s1);var t1=this._getContent();if(t1&&!t1.orgOnsapfocusleave&&t1.onsapfocusleave){t1.orgOnsapfocusleave=t1.onsapfocusleave;t1.onsapfocusleave=function(u1){var i=i1.call(this.getParent());if(i){var v1=sap.ui.getCore().byId(u1.relatedControlId);if(v1&&c(i.getDomRef(),v1.getFocusDomRef())){u1.stopPropagation();return;}}this.orgOnsapfocusleave(u1);};}}}function p1(i){var s1=i1.call(this);if(s1&&i.addEndIcon){var t1=s1.getIcon();var u1=i.getAggregation("_endIcon",[])[0];if(u1){u1.setSrc(t1);}else{i.addEndIcon({id:i.getId()+"-vhi",src:t1,useIconTooltip:false,noTabStop:true,press:function(v1){if(!this.getValueHelpOnly()){var w1;if(D.support.touch){w1=this.$('inner');w1.attr('readonly','readonly');this.focus();w1.removeAttr('readonly');}else{this.focus();}this.bValueHelpRequested=true;this.fireValueHelpRequest({fromSuggestions:false});}}.bind(i)});}}}function q1(i,s1){if(s1==="remove"){i.detachEvent("dataUpdate",r1,this);}else if(s1==="insert"){i.attachEvent("dataUpdate",r1,this);r1.call(this);}}function r1(){if(this.getEditMode()===E.Display){var i=this.getFieldInfo();var s1=this;i.isTriggerable().then(function(t1){s1._bTriggerable=t1;if(s1.getAggregation("_content")){L.call(s1);}});}}return f;},true);
