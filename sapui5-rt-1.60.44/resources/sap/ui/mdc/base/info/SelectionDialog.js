/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2018 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/core/XMLComposite','sap/ui/model/Filter','sap/ui/model/FilterOperator','sap/ui/base/ManagedObjectObserver','sap/base/Log','sap/ui/Device','sap/ui/model/json/JSONModel','sap/m/MessageBox'],function(X,F,a,M,L,D,J,b){"use strict";var S=X.extend("sap.ui.mdc.base.info.SelectionDialog",{metadata:{library:"sap.ui.mdc",properties:{showItemAsLink:{type:"boolean",defaultValue:true,invalidate:true},showReset:{type:"boolean",defaultValue:false,invalidate:true},showResetEnabled:{type:"boolean",defaultValue:false,invalidate:true}},defaultAggregation:"items",aggregations:{items:{type:"sap.ui.mdc.base.info.SelectionDialogItem",multiple:true,singularName:"item"}},events:{change:{},ok:{},cancel:{},reset:{}}}});S.prototype.init=function(){var d=new J(D);d.setDefaultBindingMode("OneWay");this.setModel(d,"device");this._oObserver=new M(_.bind(this));this._oObserver.observe(this,{aggregations:["items"]});};S.prototype.open=function(){this._updateCounts();this._getCompositeAggregation().open();};S.prototype.close=function(){this._getCompositeAggregation().close();};S.prototype.onSearchFieldLiveChange=function(e){var f=[];var s=e.getSource();var c=s?s.getValue():"";if(c){f.push(new F([new F("text",a.Contains,c),new F("tooltip",a.Contains,c),new F("description",a.Contains,c)],false));}this._getTable().getBinding("items").filter(f);};S.prototype.onPressOk=function(){this.fireOk();};S.prototype.onPressCancel=function(){this.fireCancel();};S.prototype.onPressReset=function(){this.fireReset();};S.prototype.onPressLink=function(e){var h=e.getParameter("href");if(e.getParameter("target")!=="_blank"){e.preventDefault();b.show(sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc").getText("info.SELECTION_DIALOG_LINK_VALIDATION_QUESTION"),{icon:b.Icon.WARNING,title:sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc").getText("info.SELECTION_DIALOG_LINK_VALIDATION_TITLE"),actions:[b.Action.YES,b.Action.NO],onClose:function(A){if(A===b.Action.YES){window.location.href=h;}},styleClass:this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":""});}};S.prototype._getTable=function(){return sap.ui.getCore().byId(this.getId()+"--idList")||null;};S.prototype._updateCounts=function(){var c=0;this.getItems().forEach(function(i){if(i.getVisible()){c++;}});this._getManagedObjectModel().setProperty("/@custom/countOfSelectedItems",c);};function _(c){if(c.object.isA("sap.ui.mdc.base.info.SelectionDialog")){switch(c.name){case"items":var i=c.child?[c.child]:c.children;i.forEach(function(I){switch(c.mutation){case"insert":this._oObserver.observe(I,{properties:["visible"]});break;case"remove":this._oObserver.unobserve(I);break;default:L.error("Mutation '"+c.mutation+"' is not supported jet.");}},this);break;default:L.error("The property or aggregation '"+c.name+"' has not been registered.");}}else if(c.object.isA("sap.ui.mdc.base.info.SelectionDialogItem")){if(c.name==="visible"){this._updateCounts();this.fireChange();}}}return S;},true);
