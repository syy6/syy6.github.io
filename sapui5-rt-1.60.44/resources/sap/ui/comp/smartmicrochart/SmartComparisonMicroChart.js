/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2018 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/comp/library","sap/suite/ui/microchart/library","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/comp/smartmicrochart/SmartMicroChartCommons","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log"],function(C,M,a,b,S,D,m,L){"use strict";var c=m.Size;var d=a.extend("sap.ui.comp.smartmicrochart.SmartComparisonMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartComparisonMicroChart.designtime",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},chartType:{type:"string",group:"Misc",defaultValue:"Comparison"},chartBindingPath:{type:"string",group:"Misc",defaultValue:null},isResponsive:{type:"boolean",group:"Appearance",defaultValue:false},width:{type:"sap.ui.core.CSSSize",group:"Misc"},height:{type:"sap.ui.core.CSSSize",group:"Misc"}},defaultAggregation:"_chart",aggregations:{_chart:{type:"sap.suite.ui.microchart.ComparisonMicroChart",multiple:false,visibility:"hidden"},_chartTexts:{type:"sap.m.ListBase",multiple:false,visibility:"hidden"}},associations:{chartTitle:{type:"sap.m.Label",group:"Misc",multiple:false},chartDescription:{type:"sap.m.Label",group:"Misc",multiple:false},unitOfMeasure:{type:"sap.m.Label",group:"Misc",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{initialize:{}}},renderer:"sap.ui.comp.smartmicrochart.SmartMicroChartRenderer"});d._CHART_TYPE=["Comparison"];d.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Comparison",true);this.setAggregation("_chart",new M.ComparisonMicroChart(),true);};d.prototype.onBeforeRendering=function(){var o=this.getAggregation("_chart");if(this.getIsResponsive()){o.setProperty("size",c.Responsive,true);o.setProperty("width",null,true);o.setProperty("height",null,true);}else{o.setProperty("size",c.Auto,true);o.setProperty("width",this.getWidth(),true);o.setProperty("height",this.getHeight(),true);}M._passParentContextToChild(this,o);};d.prototype.exit=function(){S._cleanup.call(this);};d.prototype.setEntitySet=function(e){if(this.getProperty("entitySet")!==e){this.setProperty("entitySet",e,true);S._initializeMetadata.call(this);}return this;};d.prototype.addAriaLabelledBy=function(A){this.addAssociation("ariaLabelledBy",A,true);this.getAggregation("_chart").addAriaLabelledBy(A);return this;};d.prototype.removeAriaLabelledBy=function(A){this.removeAssociation("ariaLabelledBy",A,true);this.getAggregation("_chart").removeAriaLabelledBy(A);return this;};d.prototype.removeAllAriaLabelledBy=function(){this.removeAllAssociation("ariaLabelledBy",true);this.getAggregation("_chart").removeAllAriaLabelledBy();return this;};d.prototype.setChartType=function(){return this;};d.prototype.propagateProperties=function(){if(a.prototype.propagateProperties){a.prototype.propagateProperties.apply(this,arguments);}S._initializeMetadata.call(this);};d.prototype._getBindingPath=function(){if(this.getChartBindingPath()){return this.getChartBindingPath();}else if(this.getEntitySet()){return"/"+this.getEntitySet();}else{return"";}};d.prototype._createAndBindInnerChart=function(){if(!(this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path)){L.error("Value DataPoint annotation missing! Cannot create the SmartComparisonMicroChart");return;}var o=this.getAggregation("_chart"),B=new M.ComparisonMicroChartData({value:{path:this._oDataPointAnnotations.Value.Path,type:"sap.ui.model.odata.type.Decimal"}});if(this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path){B.bindProperty("color",this._oDataPointAnnotations.Criticality.Path);}if(this._oDataPointAnnotations.Title&&this._oDataPointAnnotations.Title.Path){B.bindProperty("title",this._oDataPointAnnotations.Title.Path);}var A=S._getPropertyAnnotation.call(this,this._oDataPointAnnotations.Value.Path);var e=A["com.sap.vocabularies.Common.v1.Text"];if(e&&e.Path){B.bindProperty("displayValue",e.Path);}o.bindAggregation("data",{path:this._getBindingPath(),template:B,events:{change:this._onBindingDataChange.bind(this)}});};d.prototype._onBindingDataChange=function(){var o=this.getAggregation("_chart").getBinding("data");this._updateAssociations(o);};d.prototype._updateAssociations=function(o){var e=o.getContexts(0,1)[0],f=e&&e.getObject();S._updateAssociations.call(this,f);};d.prototype._getSupportedChartTypes=function(){return d._CHART_TYPE;};d.prototype.getAccessibilityInfo=function(){return S._getAccessibilityInfo.apply(this);};return d;});
