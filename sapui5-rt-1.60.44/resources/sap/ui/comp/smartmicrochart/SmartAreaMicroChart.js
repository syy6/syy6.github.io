/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2018 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/comp/library","sap/suite/ui/microchart/library","sap/ui/core/Control","sap/m/library","sap/ui/model/odata/CountMode","sap/ui/comp/smartmicrochart/SmartMicroChartCommons","sap/ui/core/format/DateFormat"],function(C,M,a,b,c,S,D){"use strict";var V=b.ValueColor;var d=a.extend("sap.ui.comp.smartmicrochart.SmartAreaMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartAreaMicroChart.designtime",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},showLabel:{type:"boolean",group:"Appearance",defaultValue:true},chartType:{type:"string",group:"Misc",defaultValue:null},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:true},chartBindingPath:{type:"string",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"164px"},height:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"74px"},isResponsive:{type:"boolean",group:"Appearance",defaultValue:false}},defaultAggregation:"_chart",aggregations:{_chart:{type:"sap.suite.ui.microchart.AreaMicroChart",multiple:false,visibility:"hidden"},_chartTexts:{type:"sap.m.ListBase",multiple:false,visibility:"hidden"}},associations:{chartTitle:{type:"sap.m.Label",group:"Misc",multiple:false},chartDescription:{type:"sap.m.Label",group:"Misc",multiple:false},unitOfMeasure:{type:"sap.m.Label",group:"Misc",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{initialize:{}}},renderer:"sap.ui.comp.smartmicrochart.SmartMicroChartRenderer"});d._CHART_TYPE=["Area","Line"];d.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Area",true);this.setAggregation("_chart",new M.AreaMicroChart(),true);};d.prototype.onBeforeRendering=function(){var o=this.getAggregation("_chart");o.setProperty("width",this.getWidth(),true);o.setProperty("height",this.getHeight(),true);o.setProperty("isResponsive",this.getIsResponsive(),true);M._passParentContextToChild(this,o);};d.prototype.destroy=function(){S._cleanup.call(this);a.prototype.destroy.apply(this,arguments);};d.prototype.setEntitySet=function(e){if(this.getProperty("entitySet")!==e){this.setProperty("entitySet",e,true);S._initializeMetadata.call(this);}return this;};d.prototype.setShowLabel=function(s){if(this.getShowLabel()!==s){this.setProperty("showLabel",s,true);this.getAggregation("_chart").setProperty("showLabel",s,true);this.invalidate();}return this;};d.prototype.addAriaLabelledBy=function(A){this.addAssociation("ariaLabelledBy",A,true);this.getAggregation("_chart").addAriaLabelledBy(A);return this;};d.prototype.removeAriaLabelledBy=function(A){this.removeAssociation("ariaLabelledBy",A,true);this.getAggregation("_chart").removeAriaLabelledBy(A);return this;};d.prototype.removeAllAriaLabelledBy=function(){this.removeAllAssociation("ariaLabelledBy",true);this.getAggregation("_chart").removeAllAriaLabelledBy();return this;};d.prototype.setEnableAutoBinding=function(){return this.setProperty("enableAutoBinding",true,true);};d.prototype.setChartType=function(){return this;};d.prototype.propagateProperties=function(){if(a.prototype.propagateProperties){a.prototype.propagateProperties.apply(this,arguments);}S._initializeMetadata.call(this);};d.prototype._getBindingPath=function(){if(this.getChartBindingPath()){return this.getChartBindingPath();}else if(this.getEntitySet()){return"/"+this.getEntitySet();}else{return"";}};d.prototype.bindElement=function(){return this;};d.prototype._createAndBindInnerChart=function(){this._createChartLabels();this._createChartItem("chart",this._oDataPointAnnotations.Value.Path);this._createChartItem("target",this._oDataPointAnnotations.TargetValue.Path);this._buildThreshold();};d.prototype._buildThreshold=function(){var o=this._oDataPointAnnotations.CriticalityCalculation;if(S._hasMember(o,"ImprovementDirection.EnumMember")){switch(o.ImprovementDirection.EnumMember){case S._MINIMIZE:this._createChartItem("minThreshold",o.ToleranceRangeHighValue.Path,V.Good);this._createChartItem("maxThreshold",o.DeviationRangeHighValue.Path,V.Error);break;case S._MAXIMIZE:this._createChartItem("minThreshold",o.DeviationRangeLowValue.Path,V.Error);this._createChartItem("maxThreshold",o.ToleranceRangeLowValue.Path,V.Good);break;case S._TARGET:this._createChartItem("minThreshold",o.DeviationRangeLowValue.Path,V.Error);this._createChartItem("maxThreshold",o.DeviationRangeHighValue.Path,V.Error);this._createChartItem("innerMinThreshold",o.ToleranceRangeLowValue.Path,V.Good);this._createChartItem("innerMaxThreshold",o.ToleranceRangeHighValue.Path,V.Good);break;default:break;}}};d.prototype._createChartLabels=function(){var l,m=this._getLabelsMap();for(var k in m){l=new M.AreaMicroChartLabel();this.getAggregation("_chart").setAggregation(m[k],l,true);}};d.prototype._createChartItem=function(e,p,f){var P,i;P=new M.AreaMicroChartPoint({x:{path:this._oChartViewMetadata.dimensionFields[0],formatter:S._formatDimension.bind(this)},y:{path:p,type:"sap.ui.model.odata.type.Decimal"}});i=new M.AreaMicroChartItem({points:{path:this._getBindingPath(),template:P,parameters:{countMode:c.None},events:{change:this._onBindingDataChange.bind(this)}},color:f});this.getAggregation("_chart").setAggregation(e,i,true);};d.prototype._onBindingDataChange=function(){var p=this.getAggregation("_chart").getAggregation("chart").getBinding("points");this._updateAssociations(p);S.updateChartLabels.call(this,p);};d.prototype._updateLabel=function(n,o){var l=this.getAggregation("_chart").getAggregation(n);l.setProperty("label",o.text,true);if(o.color){l.setProperty("color",o.color,true);}};d.prototype._updateAssociations=function(p){var o=p.getContexts(0,1)[0],e=o&&o.getObject();S._updateAssociations.call(this,e);};d.prototype._getSupportedChartTypes=function(){return d._CHART_TYPE;};d.prototype._getLabelsMap=function(){return{"leftTop":"firstYLabel","rightTop":"lastYLabel","leftBottom":"firstXLabel","rightBottom":"lastXLabel"};};d.prototype.getAccessibilityInfo=function(){return S._getAccessibilityInfo.apply(this);};return d;});
