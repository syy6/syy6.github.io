/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2017 SAP SE. All rights reserved
    
 */
(function(){"use strict";jQuery.sap.declare("sap.fe.templates.ObjectPage.AnnotationHelper");sap.fe.templates.ObjectPage.AnnotationHelper={replaceSpecialCharsInId:function(i){if(i.indexOf(" ")>=0){jQuery.sap.log.error("Annotation Helper: Spaces are not allowed in ID parts. Please check the annotations, probably something is wrong there.");}return i.replace(/@/g,"").replace(/\//g,"::").replace(/#/g,"::");},getStableIdPartFromFacet:function(f){var h="";if(typeof this.getContext==="function"&&this.getContext()&&this.getContext().getPath()&&this.getContext().getPath().indexOf("com.sap.vocabularies.UI.v1.HeaderFacets")>=0){h="headerEditable::";}if(f.$Type&&f.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){if(f.ID&&f.ID.String){return h+f.ID.String;}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. You have to set an ID at all collection facets.");return Math.floor((Math.random()*99999)+1).toString();}}else if(f.$Type&&f.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"){if(f.ID&&f.ID.String){return h+f.ID.String;}else{return h+sap.fe.templates.ObjectPage.AnnotationHelper.replaceSpecialCharsInId(f.Target.$AnnotationPath);}}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. Please check the facet annotations.");return Math.floor((Math.random()*99999)+1).toString();}},getStableIdPartFromDataPoint:function(d){var p="";if(d.Value&&d.Value.$Path){return sap.fe.templates.ObjectPage.AnnotationHelper.replaceSpecialCharsInId(d.Value.$Path);}else if(d.Value&&d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){for(var i=0;i<d.Value.Apply.Parameters.length;i++){if(d.Value.Apply.Parameters[i].Type==="Path"){if(p){p=p+"::";}p=p+sap.fe.templates.ObjectPage.AnnotationHelper.replaceSpecialCharsInId(d.Value.Apply.Parameters[i].Value);}}return p;}else{jQuery.sap.log.error("Annotation Helper: Unable to create stable ID derived from annotations.");}},determineTableType:function(f,s){var S;if(s&&s.sections){S=s.sections[sap.fe.templates.ObjectPage.AnnotationHelper.getStableIdPartFromFacet(f)];}return(S&&(((S.tableType||S.treeTable))||(s&&s.tableType)));},buildExpressionForProgressIndicatorPercentValue:function(i,d,u){var p="0";var e;var m=i.getModel(1);var P=i.getPath(1);var b=m.createBindingContext(P);if(d.Value&&d.Value.$Path){var v="${"+d.Value.$Path+"}";var t;if(d.TargetValue){t=sap.ui.model.odata.v4.AnnotationHelper.value(d.TargetValue,{context:b});if(d.TargetValue.$Path){t="$"+t;}}var E="(({0} > 100) ? 100 : (({0} < 0) ? 0 : ({0} * 1)))";var s="(({1} > 0) ? (({0} > {1}) ? 100 : (({0} < 0) ? 0 : ({0} / {1} * 100))) : 0)";if(u){u="'"+u+"'";e="'{'= ({2} === ''%'') ? "+E+" : "+s+" '}'";p=jQuery.sap.formatMessage(e,[v,t,u]);}else{e="'{'= "+s+" '}'";p=jQuery.sap.formatMessage(e,[v,t]);}}return p;},trimCurlyBraces:function(v){return v?v.replace("{","").replace("}",""):undefined;},buildExpressionForProgressIndicatorDisplayValue:function(i,d,u){var m=i.getModel(1);var p=i.getPath(1);var b=m.createBindingContext(p);var P=[];P.push(sap.ui.model.odata.v4.AnnotationHelper.value(d.Value,{context:b}));P.push(sap.ui.model.odata.v4.AnnotationHelper.value(d.TargetValue,{context:b}));P.push(u);var D=sap.fe.templates.ObjectPage.AnnotationHelper.formatDisplayValue(P);return D;},formatDisplayValue:function(p){var d="",v=p[0],t=p[1],u=p[2];if(v){return sap.ui.getCore().getLibraryResourceBundle("sap.fe",true).then(function(r){if(u){if(u==='%'){d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_UOM_IS_PERCENT",[v]);}else{if(t){d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_UOM_IS_NOT_PERCENT",[v,t,u]);}else{d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_UOM_IS_NOT_PERCENT_NO_TARGET_VALUE",[v,u]);}}}else{if(t){d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_NO_UOM",[v,t]);}else{d=v;}}return d;});}else{jQuery.sap.log.warning("Value property is mandatory, the default (empty string) will be returned");}},buildExpressionForCriticality:function(d){var f=sap.ui.core.ValueState.None;var e;var c=d.Criticality;if(c){e="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+sap.ui.core.ValueState.Error+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Critical'') || ({0} === ''2'') || ({0} === 2) ? ''"+sap.ui.core.ValueState.Warning+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+sap.ui.core.ValueState.Success+"'' : "+"''"+sap.ui.core.ValueState.None+"'' '}'";if(c.$Path){var C='${'+c.$Path+"}";f=jQuery.sap.formatMessage(e,C);}else if(c.$EnumMember){var s="'"+c.$EnumMember+"'";f=jQuery.sap.formatMessage(e,s);}else{jQuery.sap.log.warning("Case not supported, returning the default sap.ui.core.ValueState.None");}}else{jQuery.sap.log.warning("Case not supported, returning the default sap.ui.core.ValueState.None");}return f;},buildRatingIndicatorSubtitleExpression:function(s){if(s){return"{parts: [{path: '"+s.$Path+"'}], formatter: 'sap.fe.templates.ObjectPage.AnnotationHelper.formatRatingIndicatorSubTitle'}";}},formatRatingIndicatorSubTitle:function(s){if(s){return sap.ui.getCore().getLibraryResourceBundle("sap.fe",true).then(function(r){if(this.getCustomData().length>0){return r.getText("RATING_INDICATOR_SUBTITLE",[s,this.data("Subtitle")]);}else{var S=s>1?r.getText("RATING_INDICATOR_SUBTITLE_LABEL_PLURAL"):r.getText("RATING_INDICATOR_SUBTITLE_LABEL");return r.getText("RATING_INDICATOR_SUBTITLE",[s,S]);}});}},buildRatingIndicatorFooterExpression:function(i,d){var m=i.getModel(1);var p=i.getPath(1);var b=m.createBindingContext(p);var P=[];P.push(sap.ui.model.odata.v4.AnnotationHelper.value(d.Value,{context:b}));P.push(sap.ui.model.odata.v4.AnnotationHelper.value(d.TargetValue,{context:b}));var f=sap.fe.templates.ObjectPage.AnnotationHelper.formatRatingIndicatorFooterText(P);return f;},formatRatingIndicatorFooterText:function(p){var v=p[0],t=p[1];if(v){return sap.ui.getCore().getLibraryResourceBundle("sap.fe",true).then(function(r){if(t){return r.getText("RATING_INDICATOR_FOOTER",[v,t]);}else if(this.getCustomData().length>0){return r.getText("RATING_INDICATOR_FOOTER",[v,this.data("Footer")]);}else{var R=sap.m.RatingIndicator.getMetadata().getPropertyDefaults().maxValue;return r.getText("RATING_INDICATOR_FOOTER",[v,R]);}});}},getBindingPathForOPTableandForm:function(p){var n=sap.ui.model.odata.v4.AnnotationHelper.getNavigationPath(p);if(p.indexOf('com.sap.vocabularies.UI.v1.LineItem')>-1){return"\\{path:'"+n+"',parameters:\\{$$groupId:'$auto.associations'\\}\\}";}else{return"\{path:'"+n+"',parameters:\{$$groupId:'$auto.associations'\}\}";}},getElementBinding:function(p){var n=sap.ui.model.odata.v4.AnnotationHelper.getNavigationPath(p);if(n){return"{path:'"+n+"',parameters:{$$groupId:'collection'}}";}else{return"{}";}},getEditDeleteButtonVisibility:function(r,d){if(d){if(typeof vRawValue==='object'&&r.$Path){return"{= ${"+r.$Path+"} && ${ui>/editable}}";}else{return"{= ${ui>/editable}}";}}else if(typeof vRawValue==='object'&&r.$Path){return"{= ${"+r.$Path+"} && !${ui>/editable}}";}else{return"{= !${ui>/editable}}";}},getLinkEntityType:function(c){return c.getObject();},formatTextForBreadcrumbs:function(i,t,T){var m=i.getInterface(1).getModel();var p=i.getInterface(1).getPath();var b=m.createBindingContext(p);var B=sap.ui.model.odata.v4.AnnotationHelper.value(t,{context:b});if(t&&t.$Path&&T){var s,a=T.replace(/'/g,"\\'");s="{= $"+B+" ? $"+B+" : '"+a+"' }";return s;}else{if(!B){return T||"[[no title]]";}return B;}},isDeepFacetHierarchy:function(f){if(f.Facets){for(var i=0;i<f.Facets.length;i++){if(f.Facets[i].$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){return true;}}}return false;}};sap.fe.templates.ObjectPage.AnnotationHelper.buildExpressionForProgressIndicatorPercentValue.requiresIContext=true;sap.fe.templates.ObjectPage.AnnotationHelper.formatTextForBreadcrumbs.requiresIContext=true;sap.fe.templates.ObjectPage.AnnotationHelper.buildRatingIndicatorFooterExpression.requiresIContext=true;sap.fe.templates.ObjectPage.AnnotationHelper.buildExpressionForProgressIndicatorDisplayValue.requiresIContext=true;})();
