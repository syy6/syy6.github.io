/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2017 SAP SE. All rights reserved
    
 */
sap.ui.define(["jquery.sap.global","sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/fe/controllerextensions/Transaction","sap/fe/controllerextensions/Routing","sap/fe/controllerextensions/EditFlow",'sap/fe/actions/messageHandling',"sap/fe/controllerextensions/ContextManager"],function(q,C,J,T,R,E,m,a){"use strict";return C.extend("sap.fe.templates.ListReport.ListReportController",{transaction:T,routing:R,editFlow:E,messageHandling:m,contextManager:a,onInit:function(){var t=this;this.oFilterBar=this.byId("template::listReportFilterBar");this.getView().setModel(new J(),"sap.fe.templates.ListReport");this.getView().setModel(this.transaction.getUIModel(),"ui");t.contextManager.initializeContextManager();},onAfterBinding:function(b){var t=this,l,o,i,s;if(!this._oTable){l=this.byId("template::listReportPage");this._oTable=l.getAggregation("content").getAggregation("items")[0].getAggregation("content");}o=this._oTable.done();o.then(function(c){i=c._oTable.getBinding("rows")||c._oTable.getBinding("items");s=t.routing.getDirtyState();if(Object.keys(s).length>0){i.refresh();t.routing.resetDirtyState();}});},setShareModel:function(){var g=q.sap.getObject("sap.ushell.Container.getUser");var s={bookmarkTitle:document.title,bookmarkCustomUrl:function(){var h=hasher.getHash();return h?("#"+h):window.location.href;},isShareInJamActive:!!g&&g().isJamActive()};var t=this.getOwnerComponent().getModel("_templPriv");t.setProperty("/listReport/share",s);},handlers:{onSearch:function(){if(this.oFilterBar.getLiveUpdate()===false){}},onFilterBarChange:function(){if(this.oFilterBar.getLiveUpdate()){}},onShareListReportActionButtonPress:function(e){var l=this.getView().getModel("sap.fe.i18n").getResourceBundle();if(!this._oShareActionButton){this._oShareActionButton=sap.ui.xmlfragment("sap.fe.templates.ListReport.ShareSheet",{shareEmailPressed:function(){sap.m.URLHelper.triggerEmail(null,l.getText("SAPFE_EMAIL_SUBJECT",[document.title]),document.URL);},shareJamPressed:function(){}});this.getView().addDependent(this._oShareActionButton);}this._oShareActionButton.openBy(e.getSource());},onDataReceived:function(){setTimeout(this.messageHandling.showUnboundMessages,0);}}});});
